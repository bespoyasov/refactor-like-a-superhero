# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–æ–¥—É–ª–µ–π

–°–ª–æ–∂–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è—Ç –∏–∑ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —á–∞—Å—Ç–µ–π. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —á–∞—Å—Ç–µ–π –º–µ–∂–¥—É —Å–æ–±–æ–π –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∏ —Å–ª–æ–∂–Ω–æ—Å—Ç—å –∫–æ–¥–∞. –ß–µ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ –ø—Ä–æ—â–µ –∏ –æ—á–µ–≤–∏–¥–Ω–µ–µ, —Ç–µ–º –ª–µ–≥—á–µ —á–∏—Ç–∞—Ç—å –∏ –∏–∑–º–µ–Ω–∏—Ç—å –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –í —ç—Ç–æ–π –≥–ª–∞–≤–µ –º—ã —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º, –∫–∞–∫ –∑–∞–º–µ—á–∞—Ç—å —á—Ä–µ–∑–º–µ—Ä–Ω–æ –∑–∞–ø—É—Ç–∞–Ω–Ω—É—é –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—é –∫–æ–¥–∞ –∏ –∫–∞–∫ —É–ø—Ä–æ—â–∞—Ç—å –∫–æ–º–ø–æ–Ω–æ–≤–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

## –ó–∞—Ü–µ–ø–ª–µ–Ω–∏–µ –∏ —Å–≤—è–∑–Ω–æ—Å—Ç—å

–ü–ª–æ—Ö–æ–π –∫–æ–¥ –∑–∞–º–µ—Ç–µ–Ω –ø–æ —Å—Ç—Ä–∞—Ö—É –µ–≥–æ –º–µ–Ω—è—Ç—å. –°—Ç—Ä–∞—Ö –≤–æ–∑–Ω–∏–∫–∞–µ—Ç, –∫–æ–≥–¥–∞ –Ω–∞–º –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π ¬´–≤—Å—ë —Ä–∞–∑–≤–∞–ª–∏—Ç—Å—è¬ª –∏–ª–∏ ¬´–ø—Ä–∏–¥—ë—Ç—Å—è –æ–±–Ω–æ–≤–ª—è—Ç—å –∫—É—á—É –¥—Ä—É–≥–æ–≥–æ –∫–æ–¥–∞¬ª. –¢–∞–∫–∏–µ –æ—â—É—â–µ–Ω–∏—è –≤–æ–∑–Ω–∏–∫–∞—é—Ç, –µ—Å–ª–∏ –º–æ–¥—É–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–Ω–∞—é—Ç –¥—Ä—É–≥ –æ –¥—Ä—É–≥–µ.

| –ö —Å–ª–æ–≤—É üß©                                                                                                                                                              |
| :---------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| –ü–æ–¥ –º–æ–¥—É–ª–µ–º –º—ã –±—É–¥–µ–º –ø–æ–Ω–∏–º–∞—Ç—å –æ–±–æ—Å–æ–±–ª–µ–Ω–Ω—É—é —á–∞—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä–∞—è –æ—Ç–≤–µ—á–∞–µ—Ç –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é –∑–∞–¥–∞—á—É –∏ –æ–±—â–∞–µ—Ç—Å—è —Å –≤–Ω–µ—à–Ω–∏–º –º–∏—Ä–æ–º –∏–ª–∏ –¥—Ä—É–≥–∏–º–∏ –º–æ–¥—É–ª—è–º–∏ —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω–æ–µ API. |

–ö–æ–≥–¥–∞ –æ—Ç –æ–¥–Ω–æ–≥–æ –º–æ–¥—É–ª—è –∑–∞–≤–∏—Å–∏—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–µ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –¥—Ä—É–≥–∏—Ö, –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –Ω—ë–º –≤–ª–∏—è—é—Ç –Ω–∞ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ —Ç–æ–∂–µ. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ç–∞–∫–æ–º —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Ç—Ä—É–¥–Ω–æ. –†–∞–±–æ—Ç–∞ –Ω–∞–¥ –∑–∞–¥–∞—á–µ–π, –Ω–∞—á–∏–Ω–∞–µ—Ç –∑–∞—Ç—Ä–∞–≥–∏–≤–∞—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∫ –Ω–µ–π –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è. –ò–∑-–∑–∞ —ç—Ç–æ–≥–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è —Å—Ç—Ä–∞—à–Ω–æ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è, –ø–æ—Ç–æ–º—É —á—Ç–æ —Å–ª–æ–º–∞—Ç—å—Å—è –º–æ–∂–µ—Ç —á—Ç–æ —É–≥–æ–¥–Ω–æ –∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–µ—Ä–µ–ø—Ä–æ–≤–µ—Ä—è—Ç—å —Ä–∞–±–æ—Ç—É –≤—Å–µ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–°—Ç–µ–ø–µ–Ω—å –∑–Ω–∞–Ω–∏—è –æ–¥–Ω–æ–≥–æ –º–æ–¥—É–ª—è –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –¥—Ä—É–≥–∏—Ö –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è _–∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ–º (coupling)_.[^coupling] –ß–µ–º –≤—ã—à–µ –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ, —Ç–µ–º —Å–ª–æ–∂–Ω–µ–µ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑–æ–ª–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –º–æ–¥—É–ª—å.

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏

–í —Ö–æ—Ä–æ—à–æ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ —Ä–∞–±–æ—Ç–∞ –Ω–∞–¥ –∑–∞–¥–∞—á–µ–π –≤—ã–∑—ã–≤–∞–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –≤ –∫–æ–¥–µ, –∫–æ—Ç–æ—Ä—ã–π —Å–≤—è–∑–∞–Ω —Å —ç—Ç–æ–π –∑–∞–¥–∞—á–µ–π. –≠—Ç–æ—Ç –ø—Ä–∏–Ω—Ü–∏–ø –∏–∑–≤–µ—Å—Ç–µ–Ω, –∫–∞–∫ _—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ (Separation of Concerns, SoC)_.[^soc]

–≠—Ç–æ—Ç –ø—Ä–∏–Ω—Ü–∏–ø –ø–æ–º–æ–≥–∞–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞—Ç—å —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø–æ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ. –ï—Å–ª–∏ –≤–µ—Å—å –∫–æ–¥, –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π –∑–∞ –æ–¥–Ω—É –∑–∞–¥–∞—á—É, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –æ–¥–Ω–æ–º –º–æ–¥—É–ª–µ, —Ç–æ –∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —ç—Ç–æ–π –∑–∞–¥–∞—á–∏ –±—É–¥—É—Ç –≤–ª–∏—è—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ —ç—Ç–æ—Ç –º–æ–¥—É–ª—å. –í—Å—ë, —á—Ç–æ –∫ –∑–∞–¥–∞—á–µ –Ω–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è, –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–∞ –ø—Ä–µ–¥–µ–ª–∞–º–∏ –º–æ–¥—É–ª—è –∏ –Ω–µ –ø–æ–≤–ª–∏—è–µ—Ç –Ω–∞ –µ–≥–æ –∫–æ–¥.

–°—Ç–µ–ø–µ–Ω—å ¬´—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è¬ª –∫–æ–¥–∞ –∑–∞–¥–∞—á–µ –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è _—Å–≤—è–∑–Ω–æ—Å—Ç—å—é (cohesion)_.[^cohesion] –ß–µ–º –≤—ã—à–µ —Å–≤—è–∑–Ω–æ—Å—Ç—å –º–æ–¥—É–ª—è, —Ç–µ–º –±–ª–∏–∂–µ –µ–≥–æ –∫–æ–¥ –ø–æ —Å–º—ã—Å–ª—É –∫ –∑–∞–¥–∞—á–µ, —Ä–∞–¥–∏ –∫–æ—Ç–æ—Ä–æ–π –µ–≥–æ –Ω–∞–ø–∏—Å–∞–ª–∏ –∏ —Ç–µ–º –ø—Ä–æ—â–µ –æ—Ç—ã—Å–∫–∞—Ç—å –µ–≥–æ –≤ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ.

### –ü—Ä–∞–≤–∏–ª–æ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –º–æ–¥—É–ª–µ–π

–ü–µ—Ä–≤–æ–µ –∏ –≥–ª–∞–≤–Ω–æ–µ, —á—Ç–æ –Ω–∞–º —Å—Ç–æ–∏—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –º–æ–¥—É–ª–µ–π –≤–æ –≤—Ä–µ–º—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞, —ç—Ç–æ –ø—Ä–∞–≤–∏–ª–æ:

---

**‚ùóÔ∏è –ó–∞—Ü–µ–ø–ª–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∏–∑–∫–∏–º, –∞ —Å–≤—è–∑–Ω–æ—Å—Ç—å ‚Äî –≤—ã—Å–æ–∫–æ–π**

---

–°–∫–æ–º–ø–æ–Ω–æ–≤–∞–Ω–Ω–∞—è –ø–æ —Ç–∞–∫–æ–º—É –ø—Ä–∞–≤–∏–ª—É –ø—Ä–æ–≥—Ä–∞–º–º–∞ –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ ¬´–æ—Å—Ç—Ä–æ–≤–∫–∏ –∑–∞–¥–∞—á¬ª, —Å–≤—è–∑–∞–Ω–Ω—ã–µ ¬´–º–æ—Å—Ç–∏–∫–∞–º–∏¬ª –ø—É–±–ª–∏—á–Ω–æ–≥–æ API, —Å–æ–±—ã—Ç–∏–π –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π:

<figure>
  <img src="../images/13-coupling-cohesion.png" width="600">
  <figcaption><em>¬´–û—Å—Ç—Ä–æ–≤–∫–∏¬ª –æ—Ç–≤–µ—á–∞—é—Ç –∑–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–µ –∑–∞–¥–∞—á–∏ –ø—Ä–µ–¥–º–µ—Ç–Ω–æ–π –æ–±–ª–∞—Å—Ç–∏ –∏ –æ–±—â–∞—é—Ç—Å—è –¥—Ä—É–≥ —Å –¥—Ä—É–≥–æ–º –ø–æ ¬´–º–æ—Å—Ç–∏–∫–∞–º¬ª –ø—É–±–ª–∏—á–Ω–æ–≥–æ API, —Å–æ–±—ã—Ç–∏–π –∏–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–π</em><br><br></figcaption>
</figure>

### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á

–ß—Ç–æ–±—ã –ø–æ–Ω—è—Ç—å, –ø–æ –∫–∞–∫–∏–º –ø—Ä–∏–∑–Ω–∞–∫–∞–º –≤–æ –≤—Ä–µ–º—è —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –∏—Å–∫–∞—Ç—å —Å–ª–∞–±–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á, —Ä–∞—Å—Å–º–æ—Ç—Ä–∏–º –ø—Ä–∏–º–µ—Ä. –ú–æ–¥—É–ª—å `purchase` –∏–∑ —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞ –Ω–∏–∂–µ —Å–∏–ª—å–Ω–æ –∑–∞—Ü–µ–ø–ª–µ–Ω —Å –º–æ–¥—É–ª–µ–º `cart`. –û–Ω –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–µ –¥–µ—Ç–∞–ª–∏ –æ–±—ä–µ–∫—Ç–∞ –∫–æ—Ä–∑–∏–Ω—ã (—Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ–±—ä–µ–∫—Ç–∞ –∏ —Ç–∏–ø –ø–æ–ª—è `products`), —á—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å, –ø—É—Å—Ç–∞—è –ª–∏ –æ–Ω–∞:

```ts
// purchase.ts

async function makePurchase(user, cart) {
  if (!cart.products.length) throw new Error("Cart is empty!");

  const order = createOrder(user, cart);
  await sendOrder(order);
}
```

–ü—Ä–æ–±–ª–µ–º–∞ —ç—Ç–æ–≥–æ –∫–æ–¥–∞ –≤ –Ω–∞—Ä—É—à–µ–Ω–∏–∏ –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–∏. –ú–æ–¥—É–ª—å `purchase` _–Ω–µ –∑–Ω–∞–µ—Ç –∏ –Ω–µ –¥–æ–ª–∂–µ–Ω –∑–Ω–∞—Ç—å_, –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –ø—É—Å—Ç–∞ –ª–∏ –∫–æ—Ä–∑–∏–Ω–∞.

–î–µ—Ç–∞–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã, –Ω–µ –≤—Ö–æ–¥—è—Ç –≤ –∑–∞–¥–∞—á—É –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞. –ù–∞–º –≤–∞–∂–µ–Ω _—Ñ–∞–∫—Ç_, —á—Ç–æ –∫–æ—Ä–∑–∏–Ω–∞ –Ω–µ–ø—É—Å—Ç–∞—è, –Ω–æ –Ω–µ –≤–∞–∂–Ω–æ, _–∫–∞–∫_ —ç—Ç–æ—Ç —Ñ–∞–∫—Ç –±—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω. –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ–≤–µ—Ä–∫–∏ ‚Äî —ç—Ç–æ –∑–∞–¥–∞—á–∞ –º–æ–¥—É–ª—è –∫–æ—Ä–∑–∏–Ω—ã, –ø–æ—Ç–æ–º—É —á—Ç–æ –∏–º–µ–Ω–Ω–æ –æ–Ω —Å–æ–∑–¥–∞—ë—Ç —ç—Ç–æ—Ç –æ–±—ä–µ–∫—Ç –∏ –∑–Ω–∞–µ—Ç, –∫–∞–∫ –¥–µ—Ä–∂–∞—Ç—å –µ–≥–æ –≤–∞–ª–∏–¥–Ω—ã–º:

```ts
// cart.ts
// –í—ã–Ω–æ—Å–∏–º –ø—Ä–æ–≤–µ—Ä–∫—É –ø—É—Å—Ç–æ—Ç—ã –∫–æ—Ä–∑–∏–Ω—ã –≤ –º–æ–¥—É–ª—å `cart`:
export function isEmpty(cart) {
  return !cart.products.length;
}

// purchase.ts
import { createOrder } from "./order";
import { isEmpty } from "./cart";

async function makePurchase(user, cart) {
  if (isEmpty(cart)) throw new Error("Cart is empty!");

  const order = createOrder(user, cart);
  await sendOrder(order);
}
```

–¢–µ–ø–µ—Ä—å, –µ—Å–ª–∏ –≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ—Ä–∑–∏–Ω—ã –ø–æ –∫–∞–∫–∏–º-—Ç–æ –ø—Ä–∏—á–∏–Ω–∞–º –∏–∑–º–µ–Ω–∏—Ç—Å—è, –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–≥—Ä–∞–Ω–∏—á–∞—Ç—Å—è –º–æ–¥—É–ª–µ–º `cart`:

```ts
// cart.ts
type Cart = {
  // –ë—ã–ª–æ products, —Å—Ç–∞–ª–æ items:
  items: ProductList;
};

export function isEmpty(cart) {
  // –ú–µ—Å—Ç–æ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–¥–æ –ø–æ–ø—Ä–∞–≤–∏—Ç—å:
  return !cart.items.length;
}

// purchase.ts
async function makePurchase(user, cart) {
  if (isEmpty(cart)) throw new Error("Cart is empty!");
  // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª—è—Ö –æ—Å—Ç–∞–ª–æ—Å—å –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º,
  // –º—ã –æ–≥—Ä–∞–Ω–∏—á–∏–ª–∏ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π.
}
```

...–ú–æ–¥—É–ª–∏, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Ñ—É–Ω–∫—Ü–∏—é `isEmpty` –∏–∑ –ø—É–±–ª–∏—á–Ω–æ–≥–æ API, –æ—Å—Ç–∞–Ω—É—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω–Ω—ã–º–∏. –ï—Å–ª–∏ –±—ã –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –∫–æ—Ä–∑–∏–Ω—ã –Ω–∞–ø—Ä—è–º—É—é, —Ç–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Å–≤–æ–π—Å—Ç–≤–∞, –ø—Ä–∏—à–ª–æ—Å—å –±—ã –æ–±–Ω–æ–≤–ª—è—Ç—å –∏—Ö –≤—Å–µ.

### –ö–∞–∫ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å–≤—è–∑–Ω–æ—Å—Ç—å

–ß–∞—Å—Ç–æ —Å –ø–µ—Ä–≤–æ–≥–æ –≤–∑–≥–ª—è–¥–∞ –Ω–µ–ø–æ–Ω—è—Ç–Ω–æ, –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∑–∞–¥–∞—á–∞ –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –º–æ–¥—É–ª—é, –∏–ª–∏ –Ω–µ—Ç. –î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∏–ø–æ—Ç–µ–∑ –æ–± —ç—Ç–æ–º –º—ã –º–æ–∂–µ–º –æ–±—Ä–∞—â–∞—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –¥–∞–Ω–Ω—ã–µ, –∫–æ—Ç–æ—Ä—ã–º–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–æ–¥—É–ª—å –∏–ª–∏ —Ñ—É–Ω–∫—Ü–∏—è.

–î–∞–Ω–Ω—ã–µ ‚Äî —ç—Ç–æ _–≤—Ö–æ–¥–Ω—ã–µ –∏ –≤—ã—Ö–æ–¥–Ω—ã–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã_, –∞ —Ç–∞–∫–∂–µ _–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç_, –∫–æ—Ç–æ—Ä—ã–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–¥—É–ª—å. –ß–µ–º –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã–µ –æ–¥–Ω–æ–≥–æ –º–æ–¥—É–ª—è —Å—Ö–æ–∂–∏ —Å –¥–∞–Ω–Ω—ã–º–∏ –¥—Ä—É–≥–æ–≥–æ –º–æ–¥—É–ª—è, —Ç–µ–º –≤—ã—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å, —á—Ç–æ –æ–Ω–∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ —Ä–∞–∑–Ω—ã–º –∑–∞–¥–∞—á–∞–º. –ï—Å–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ñ—É–Ω–∫—Ü–∏—è —á–∞—Å—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ —Å–æ—Å–µ–¥–Ω–µ–≥–æ –º–æ–¥—É–ª—è, —Å–∫–æ—Ä–µ–µ –≤—Å–µ–≥–æ, –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –µ–≥–æ —á–∞—Å—Ç—å—é.

| –ö —Å–ª–æ–≤—É ü¶®                                                               |
| :----------------------------------------------------------------------- |
| –ú—ã –º–æ–∂–µ–º –∑–Ω–∞—Ç—å —ç—Ç—É –ø—Ä–æ–±–ª–µ–º—É –∫–∞–∫ –∑–∞–ø–∞—Ö –∫–æ–¥–∞ ‚ÄúFeature Envy‚Äù.[^faetureenvy] |

–ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –º—ã —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞ —Ä–∞—Å—Ö–æ–¥–æ–≤. –î–æ–ø—É—Å—Ç–∏–º, –≤ –º–æ–¥—É–ª–µ, –æ—Ç–≤–µ—á–∞—é—â–µ–º –∑–∞ –±—é–¥–∂–µ—Ç, –º—ã –≤–∏–¥–∏–º —Ç–∞–∫–æ–π –∫–æ–¥:

```js
// budget.js

// –°–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π –±—é–¥–∂–µ—Ç:
function createBudget(amount, days) {
  const daily = Math.floor(amount / days);
  return { amount, days, daily };
}

// –°—á–∏—Ç–∞–µ—Ç, —Å–∫–æ–ª—å–∫–æ –ø–æ—Ç—Ä–∞—á–µ–Ω–æ –≤—Å–µ–≥–æ:
function totalSpent(history) {
  return history.reduce((tally, record) => tally + record.amount, 0);
}

// –î–æ–±–∞–≤–ª—è–µ—Ç —Ç—Ä–∞—Ç—É, —É–º–µ–Ω—å—à–∞—è –¥–æ—Å—Ç—É–ø–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–Ω–µ–≥
// –∏ —Å–æ–∑–¥–∞–≤–∞—è –Ω–æ–≤—É—é –∑–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞—Ç:
function addSpending(record, { budget, history }) {
  const newBudget = { ...budget, amount: budget.amount - record.amount };
  const newHistory = [...history, record];

  return {
    budget: newBudget,
    history: newHistory,
  };
}
```

–ó–∞–¥–∞—á–∞ –º–æ–¥—É–ª—è `budget` ‚Äî –æ—Ç–≤–µ—á–∞—Ç—å –∑–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è _–±—é–¥–∂–µ—Ç–∞_. –û–¥–Ω–∞–∫–æ –º—ã –≤–∏–¥–∏–º —Ñ—É–Ω–∫—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–µ —Ç–æ–ª—å–∫–æ —Å –Ω–∏–º:

- –§—É–Ω–∫—Ü–∏—è `totalSpent` —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ —Å –∏—Å—Ç–æ—Ä–∏–µ–π –∑–∞–ø–∏—Å–µ–π –æ —Ä–∞—Å—Ö–æ–¥–∞—Ö;
- –§—É–Ω–∫—Ü–∏—è `addSpending` —Ä–∞–±–æ—Ç–∞–µ—Ç —Å –±—é–¥–∂–µ—Ç–æ–º, –Ω–æ —Ç–æ–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤.

–ò–∑ –¥–∞–Ω–Ω—ã—Ö, —Å –∫–æ—Ç–æ—Ä—ã–º–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —ç—Ç–∏ —Ñ—É–Ω–∫—Ü–∏–∏, –º—ã –º–æ–∂–µ–º —Å–¥–µ–ª–∞—Ç—å –≤—ã–≤–æ–¥, —á—Ç–æ –æ–Ω–∏ –Ω–µ —Ç–∞–∫ —É–∂ –∏ –æ—Ç–Ω–æ—Å—è—Ç—Å—è –∫ –±—é–¥–∂–µ—Ç—É. –ù–∞–ø—Ä–∏–º–µ—Ä, `totalSpent` ‚Äî –±–æ–ª—å—à–µ –æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫ –∏—Å—Ç–æ—Ä–∏–∏ —Ä–∞—Å—Ö–æ–¥–æ–≤, –∞ `addSpending` ‚Äî –±–æ–ª—å—à–µ –ø–æ—Ö–æ–∂–∞ –Ω–∞ —Ü–µ–ª—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π —Å—Ü–µ–Ω–∞—Ä–∏–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–ü–æ–ø—Ä–æ–±—É–µ–º —Ä–∞—Å–ø–∏–ª–∏—Ç—å –∫–æ–¥ –ø–æ —Ñ–∏—á–∞–º, –≤—ã–¥–µ–ª–∏–≤ –∏—Å—Ç–æ—Ä–∏—é –∏ —é–∫–∑–µ–π—Å –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏:

```js
// budget.js
// –¢—É—Ç –¥–µ—Ä–∂–∏–º —Ç–æ–ª—å–∫–æ –∫–æ–¥,
// –æ—Ç–≤–µ—á–∞—é—â–∏–π –∑–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –±—é–¥–∂–µ—Ç–∞:

function createBudget(amount, days) {
  const daily = Math.floor(amount / days);
  return { amount, days, daily };
}

function decreaseBy(budget, record) {
  const updated = budget.amount - record.amount;
  return { ...budget, amount: updated };
}

// history.js
// –ó–¥–µ—Å—å —Ç–æ–ª—å–∫–æ –∫–æ–¥, –æ—Ç–≤–µ—á–∞—é—â–∏–π
// –∑–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏ —Ç—Ä–∞—Ç:

function totalSpent(history) {
  return history.reduce((tally, record) => tally + record.amount, 0);
}

function appendRecord(history, record) {
  return [...history, record];
}

// addSpending.js
// –ó–¥–µ—Å—å –æ–ø–∏—Å—ã–≤–∞–µ–º —é–∑–∫–µ–π—Å –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ç—Ä–∞—Ç—ã:
// - —É–º–µ–Ω—å—à–∞–µ–º –±—é–¥–∂–µ—Ç;
// - –¥–æ–±–∞–≤–ª—è–µ–º –∑–∞–ø–∏—Å—å –≤ –∏—Å—Ç–æ—Ä–∏—é.

function addSpending(spending, appState) {
  const budget = decreaseBy(state.budget, spending);
  const history = appendRecord(state.history, spending);
  return { budget, history };
}
```

–í –Ω–∞—á–∞–ª–µ –∂–∏–∑–Ω–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –ø–æ–¥–æ–±–Ω–æ–µ —Å—Ç—Ä–æ–≥–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π –∏ —Ñ–∏—á –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–µ –Ω—É–∂–Ω–æ. –ù–æ –µ—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞–¥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å –∏ –¥–æ–±–∞–≤–ª—è—Ç—å –±–æ–ª—å—à–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤, –≤–µ—Ä–æ—è—Ç–Ω–æ, –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–≤–º–µ—â–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–∞–∑–Ω—ã—Ö –º–æ–¥—É–ª–µ–π. –ù–µ—á—ë—Ç–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –Ω–µ—è–≤–Ω—ã–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –º–µ–∂–¥—É –Ω–∏–º–∏, –∏–∑-–∑–∞ –∫–æ—Ç–æ—Ä—ã—Ö –∫–æ–º–ø–æ–Ω–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –±—É–¥–µ—Ç —Å–ª–æ–∂–Ω–µ–µ.

–î–ª—è –±–µ—Å–ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –Ω–∞–º —Å—Ç–æ–∏—Ç —Å–ª–µ–¥–∏—Ç—å –∑–∞ –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ–º –∏ —Å–≤—è–∑–Ω–æ—Å—Ç—å—é. –ï—Å–ª–∏ –º—ã –∑–Ω–∞–µ–º, —á—Ç–æ –±—É–¥–µ–º —Ä–∞—Å—à–∏—Ä—è—Ç—å –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å, —Ç–æ –ª—É—á—à–µ —Ä–∞–∑–¥–µ–ª–∏—Ç—å –∫–æ–¥ –ø–æ —Ä–∞–∑–Ω—ã–º –º–æ–¥—É–ª—è–º —Ç–∞–∫, —á—Ç–æ–±—ã –º–µ–∂–¥—É –Ω–∏–º–∏ –±—ã–ª–æ –º–∏–Ω–∏–º—É–º —Å–∫—Ä—ã—Ç—ã—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.

## –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã

–ü—É–±–ª–∏—á–Ω–æ–µ API –º–æ–¥—É–ª—è –º–æ–∂–Ω–æ –Ω–∞–∑–≤–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Ñ–æ—Ä–º–æ–π _–∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞_.[^designbycontract][^contractprogramming] –ö–æ–Ω—Ç—Ä–∞–∫—Ç—ã —Ñ–∏–∫—Å–∏—Ä—É—é—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ –æ–¥–Ω–æ–π —Å—É—â–Ω–æ—Å—Ç–∏ –ø–µ—Ä–µ–¥ –¥—Ä—É–≥–∏–º–∏: –æ–Ω–∏ —Ç—Ä–µ–±—É—é—Ç –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –∏ –æ–±—è–∑—É—é—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –≠—Ç–æ –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥—Ä—É–≥–∏–º —á–∞—Å—Ç—è–º –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ–ª–∞–≥–∞—Ç—å—Å—è –Ω–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –º–æ–¥—É–ª—è, –∞ —Ç–æ–ª—å–∫–æ –Ω–∞ –µ–≥–æ ¬´–æ–±–µ—â–∞–Ω–∏—è¬ª –∏ —Å—Ç—Ä–æ–∏—Ç—å —Å–≤–æ—é —Ä–∞–±–æ—Ç—É –∏—Å—Ö–æ–¥—è –∏–∑ –Ω–∏—Ö.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ, –∑–∞—á–µ–º —ç—Ç–æ –Ω—É–∂–Ω–æ. –í –∫–æ–¥–µ –Ω–∏–∂–µ –º—ã –æ–ø–∏—Ä–∞–µ–º—Å—è –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –º–æ–¥—É–ª—è `api`, —Ç–µ–º —Å–∞–º—ã–º –ø–æ–≤—ã—à–∞—è –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ:

```ts
// ...
await api.post(api.baseUrl + "/" + api.createUserUrl, { body: user });
// ...
await api.post(api.baseUrl + "/posts/" + api.posts.create, post);
```

–ú–æ–¥—É–ª—å `api` –Ω–µ –¥–∞—ë—Ç —á—ë—Ç–∫–∏—Ö –æ–±–µ—â–∞–Ω–∏–π, –∫–∞–∫ –æ–Ω –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ –µ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –Ω–∞–º –Ω–∞–¥–æ –∑–Ω–∞—Ç—å, –∫–∞–∫ –æ–Ω —É—Å—Ç—Ä–æ–µ–Ω. –ù–æ –ø—Ä—è–º–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç ¬´–≤–Ω—É—Ç—Ä–µ–Ω–Ω–æ—Å—Ç–µ–π¬ª –ø–æ–≤—ã—à–∞–µ—Ç –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ: –µ—Å–ª–∏ –º—ã –∏–∑–º–µ–Ω–∏–º –º–æ–¥—É–ª—å `api`, —Ç–æ –ø—Ä–∏–¥—ë—Ç—Å—è –º–µ–Ω—è—Ç—å –∏ –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç. –≠—Ç–æ —Ç–æ—Ä–º–æ–∑–∏—Ç —Ä–∞–∑–≤–∏—Ç–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—å `api` –º–æ–≥ –±—ã –æ–±—ä—è–≤–∏—Ç—å _–∫–æ–Ω—Ç—Ä–∞–∫—Ç_ ‚Äî –Ω–∞–±–æ—Ä –≥–∞—Ä–∞–Ω—Ç–∏–π, –æ–ø–∏—Å—ã–≤–∞—é—â–∏—Ö –∫–∞–∫ –æ–Ω –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å:

```ts
type ApiResponse = {
  state: "OK" | "ERROR";
};

interface ApiClient {
  createUser(user: User): Promise<ApiResponse>;
  createPost(post: Post): Promise<ApiResponse>;
}
```

–ó–∞—Ç–µ–º –º—ã –±—ã —Ä–µ–∞–ª–∏–∑–æ–≤–∞–ª–∏ —ç—Ç–æ—Ç –∫–æ–Ω—Ç—Ä–∞–∫—Ç –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª—è `api`, –Ω–µ –≤—ã–ø—É—Å–∫–∞—è –Ω–∞—Ä—É–∂—É –ª–∏—à–Ω–∏—Ö –¥–µ—Ç–∞–ª–µ–π:

```ts
const client: ApiClient = {
  createUser: (user) =>
    api.post(api.baseUrl + "/" + api.createUserUrl, { body: user }),

  createPost: (post) =>
    api.post(api.baseUrl + "/posts/" + api.posts.create, post),
};
```

...–ê –ø–æ—Å–ª–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –±—ã –µ–≥–æ, —É–∂–µ –æ–ø–∏—Ä–∞—è—Å—å —Ç–æ–ª—å–∫–æ –Ω–∞ –∫–æ–Ω—Ç—Ä–∞–∫—Ç:

```ts
// ...
await client.createUser(user);
// ...
await client.createPost(post);
```

| –£—Ç–æ—á–Ω–µ–Ω–∏–µ üìë                                                                                                                                                                                                                           |
| :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| –í —Ñ–æ—Ä–º–∞–ª—å–Ω–æ–º –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–∏ –∫–æ–Ω—Ç—Ä–∞–∫—Ç—ã ‚Äî —ç—Ç–æ –ø—Ä–µ–¥- –∏ –ø–æ—Å—Ç—É—Å–ª–æ–≤–∏—è –≤ –≤–∏–¥–µ –ø—Ä–æ–ø–∏—Å–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä—è–µ–º—ã—Ö —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π.[^designbycontract] –ù–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ —è –ø–æ—á—Ç–∏ –Ω–µ –≤—Å—Ç—Ä–µ—á–∞–ª –∫–æ–Ω—Ç—Ä–∞–∫—Ç–æ–≤ –≤ —Ç–∞–∫–æ–º –≤–∏–¥–µ, –∑–∞—Ç–æ –≤ –≤–∏–¥–µ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∏—è –≥–∞—Ä–∞–Ω—Ç–∏–π ‚Äî –ø–æ–≤—Å–µ–º–µ—Å—Ç–Ω–æ. |
| –ì–∞—Ä–∞–Ω—Ç–∏–∏ ‚Äî —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ –∏–ª–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å. –≠—Ç–æ –º–æ–≥—É—Ç –±—ã—Ç—å —É—Å—Ç–Ω—ã–µ –∏–ª–∏ –ø–∏—Å—å–º–µ–Ω–Ω—ã–µ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏, DTO, —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏–π –∏ —Ç.–¥. –ì–ª–∞–≤–Ω–æ–µ, —á—Ç–æ–±—ã —ç—Ç–∏ –¥–æ–≥–æ–≤–æ—Ä—ë–Ω–Ω–æ—Å—Ç–∏ _—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–ª–∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ_ —á–∞—Å—Ç–µ–π —Å–∏—Å—Ç–µ–º—ã –¥—Ä—É–≥ –ø–µ—Ä–µ–¥ –¥—Ä—É–≥–æ–º.   |

–û–¥–Ω–∏ –∏ —Ç–µ –∂–µ –æ–±–µ—â–∞–Ω–∏—è –º–æ–≥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å —Ä–∞–∑–Ω—ã–µ –º–æ–¥—É–ª–∏, –ø–æ—ç—Ç–æ–º—É –µ—Å–ª–∏ –æ–ø–∏—Ä–∞—Ç—å—Å—è –Ω–∞ –æ–±–µ—â–∞–Ω–∏—è, —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø—Ä–æ—â–µ –ø–æ–¥–º–µ–Ω—è—Ç—å, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

```ts
// –û–ø–∏—Å—ã–≤–∞–µ–º ¬´–∫–æ–Ω—Ç—Ä–∞–∫—Ç¬ª —Ä–∞–±–æ—Ç—ã —Ö—Ä–∞–Ω–∏–ª–∏—â–∞.
// –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ —É–∫–∞–∑—ã–≤–∞–µ–º, –∫–∞–∫–æ–π –º–µ—Ç–æ–¥ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å,
// —á—Ç–æ –æ–Ω –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –≤ –∫–∞—á–µ—Å—Ç–≤–µ –∞—Ä–≥—É–º–µ–Ω—Ç–∞
// –∏ —á—Ç–æ –æ–Ω –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

interface SyncStorage {
  save(value: string): void;
}

// –í –∞—Ä–≥—É–º–µ–Ω—Ç–µ `saveToStorage` —É–∫–∞–∑—ã–≤–∞–µ–º –Ω–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å,
// –∞ ¬´—á—Ç–æ-—Ç–æ, —á—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `SyncStorage`¬ª:

function saveToStorage(value: string, storage: SyncStorage) {
  if (value) storage.save(value);
}

// ...

describe("when given a non-empty value", () => {
  // –í —Ç–µ—Å—Ç–∞—Ö –æ–ø–∏—Å—ã–≤–∞–µ–º –º–æ–∫ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞,
  // –∫–∞–∫ ¬´—á—Ç–æ-—Ç–æ, —á—Ç–æ —Ä–µ–∞–ª–∏–∑—É–µ—Ç `SyncStorage`¬ª:
  const mock: SyncStorage = { save: jest.fn() };

  it("should save it into the given storage", () => {
    // –¢–æ–≥–¥–∞ –≤–æ –≤—Ä–µ–º—è —Ç–µ—Å—Ç–æ–≤ —Å–º–æ–∂–µ–º ¬´–ø–æ–¥–º–µ–Ω–∏—Ç—å¬ª
    // —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é —Ö—Ä–∞–Ω–∏–ª–∏—â–∞ –Ω–∞ –º–æ–∫:
    saveToStorage("Hello World!", mock);
    expect(mock.save).toHaveBeenCalled();
  });
});
```

...–ò–ª–∏ –¥–∞–∂–µ –≤–æ –≤—Ä–µ–º—è —Ä–∞–Ω—Ç–∞–π–º–∞ –¥–ª—è –∑–∞–º–µ–Ω—ã –æ–¥–Ω–æ–≥–æ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –∏–ª–∏ –∫—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥—Ä—É–≥–∏–º:

```js
// –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∫—É–∫–∏ –∏–ª–∏ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
// –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫:

const storage = preferences.useCookie ? cookieAdapter : localStorageAdapter;
const saveCurrentTheme = () => saveToStorage(THEME, storage);

// –ü–æ–∫–∞ `cookieAdapter` –∏ `localStorageAdapter` –æ–±–∞ —Ä–µ–∞–ª–∏–∑—É—é—Ç `SyncStorage`,
// –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ª—é–±–æ–π –∏–∑ –Ω–∏—Ö –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `saveToStorage`.
```

| –ö —Å–ª–æ–≤—É üîÅ                                                                                                                |
| :------------------------------------------------------------------------------------------------------------------------ |
| –ò–¥–µ—è —Ç–∞–∫–æ–π ¬´–ø–æ–¥–º–µ–Ω—ã¬ª –º–æ–¥—É–ª–µ–π –ª–µ–∂–∏—Ç –≤ –æ—Å–Ω–æ–≤–µ —à–∞–±–ª–æ–Ω–∞ ¬´–°—Ç—Ä–∞—Ç–µ–≥–∏—è¬ª –∏ –∏–Ω—ä–µ–∫—Ü–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.[^strategy][^di][^ditsinpractice] |

### –°–æ–±—ã—Ç–∏—è –∏ —Å–æ–æ–±—â–µ–Ω–∏—è

–ß–µ–º –Ω–∏–∂–µ –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ, —Ç–µ–º –±–æ–ª—å—à–µ –æ–±—â–µ–Ω–∏–µ –º–æ–¥—É–ª–µ–π —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø–æ—Ö–æ–∂–µ –Ω–∞ –æ–±–º–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏. –û–±—â–µ–Ω–∏–µ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–æ–º –∏ –∫–ª–∏–µ–Ω—Ç–æ–º –ø–æ REST ‚Äî —ç—Ç–æ –ø—Ä–∏–º–µ—Ä —Ç–∞–∫–æ–≥–æ –æ–±—â–µ–Ω–∏—è.[^rest] –ö–ª–∏–µ–Ω—Ç –∏ —Å–µ—Ä–≤–µ—Ä –Ω–∏—á–µ–≥–æ –Ω–µ –∑–Ω–∞—é—Ç –æ–± —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –∏ –æ–±—â–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø–æ –∑–∞—Ä–∞–Ω–µ–µ –æ–ø–∏—Å–∞–Ω–Ω–æ–º—É –∫–æ–Ω—Ç—Ä–∞–∫—Ç—É ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ–≥–æ –≤–∏–¥–∞ —Å –¥–∞–Ω–Ω—ã–º–∏ –≤–Ω—É—Ç—Ä–∏.

–°–æ–æ–±—â–µ–Ω–∏—è –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∫–∞–∫ –Ω–∞–ø—Ä—è–º—É—é –æ—Ç –æ–¥–Ω–æ–≥–æ –º–æ–¥—É–ª—è –∫ –¥—Ä—É–≥–æ–º—É —á–µ—Ä–µ–∑ –ø—É–±–ª–∏—á–Ω–æ–µ API, —Ç–∞–∫ –∏ —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å ‚Äî _–ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫_. –í–æ –≤—Ç–æ—Ä–æ–º —Å–ª—É—á–∞–µ –º–æ–¥—É–ª–∏ –≤–æ–æ–±—â–µ –Ω–∏—á–µ–≥–æ –Ω–µ –±—É–¥—É—Ç –∑–Ω–∞—Ç—å –¥—Ä—É–≥ –æ –¥—Ä—É–≥–µ –∏ –±—É–¥—É—Ç –∑–∞—Ü–µ–ø–ª–µ–Ω—ã —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –∏–ª–∏ —Å–æ–±—ã—Ç–∏–π:

<figure>
  <img src="../images/13-message-bus.png" width="800">
  <figcaption><em>–û–±—â–µ–Ω–∏–µ —Å–≤–æ–¥–∏—Ç—Å—è –∫ –ø–µ—Ä–µ–¥–∞—á–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏—é —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫–∞</em><br><br></figcaption>
</figure>

| –£—Ç–æ—á–Ω–µ–Ω–∏–µ üìß                                                                                                                                                                                                                                                     |
| :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| –Ø –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ –Ω–µ –Ω–∞–∑—ã–≤–∞–ª –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫ ¬´—à–∏–Ω–æ–π —Å–æ–±—ã—Ç–∏–π¬ª, ¬´–æ—á–µ—Ä–µ–¥—å—é¬ª –∏–ª–∏ ¬´–±—Ä–æ–∫–µ—Ä–æ–º¬ª —Å–æ–æ–±—â–µ–Ω–∏–π. –ú–µ–∂–¥—É –Ω–∏–º–∏ –µ—Å—Ç—å —Ä–∞–∑–Ω–∏—Ü–∞,[^messagebroker][^messagebus][^messagequeue] –Ω–æ –¥–ª—è —Å—É—Ç–∏ —ç—Ç–æ–π –≥–ª–∞–≤—ã –æ–Ω–∞ –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–∞, –ø–æ—ç—Ç–æ–º—É —è –Ω–µ —Å—Ç–∞–ª –∑–∞–æ—Å—Ç—Ä—è—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º —Ç–µ—Ä–º–∏–Ω–µ. |

| –ö —Å–ª–æ–≤—É üìÜ                                                                                                                                                                                                                                                           |
| :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| –û–±—â–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —Å–æ–±—ã—Ç–∏—è –º–æ–∂–Ω–æ –Ω–∞–∑—ã–≤–∞—Ç—å ¬´–∏–¥–µ–∞–ª—å–Ω—ã–º –æ–±—â–µ–Ω–∏–µ–º¬ª –º–µ–∂–¥—É –º–æ–¥—É–ª—è–º–∏, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–æ —Å–≤—è–∑—ã–≤–∞–µ—Ç –º–æ–¥—É–ª–∏ —Ç–æ–ª—å–∫–æ –ø—Ä–æ—Ç–æ–∫–æ–ª–∞–º–∏ —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –∏—Ö –æ—Ç–ø—Ä–∞–≤–∫–∏. –ù–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–∫–æ–≥–æ –æ–±—â–µ–Ω–∏—è —á–∞—Å—Ç–æ —Ä–µ—Å—É—Ä—Å–æ–∑–∞—Ç—Ä–∞—Ç–Ω–∞, –∞ –¥–ª—è –º–∞–ª–µ–Ω—å–∫–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ –∏ –≤–æ–≤—Å–µ –º–æ–∂–µ—Ç –æ–∫–∞–∑–∞—Ç—å—Å—è –æ–≤–µ—Ä—Ö–µ–¥–æ–º. |

–ü–µ—Ä–µ–¥–∞—á–∞ —Å–æ–±—ã—Ç–∏–π –∏ —Å–æ–æ–±—â–µ–Ω–∏–π –æ–±—ã—á–Ω–æ –∞—Å—Å–æ—Ü–∏–∏—Ä—É–µ—Ç—Å—è —Å –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –Ω–æ –∏—Ö –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏ –≤ –æ–±—ã—á–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö. –ï—Å–ª–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±–æ–ª—å—à–æ–µ, –∏ –Ω–∞–¥–æ –ø–æ—Å—Ç—Ä–æ–∏—Ç—å –æ–±—â–µ–Ω–∏–µ –º–µ–∂–¥—É –µ–≥–æ —á–∞—Å—Ç—è–º–∏ –±–µ–∑ –∑–∞—Ü–µ–ø–ª–µ–Ω–∏—è, —Ç–æ –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫ –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å —Ä–µ—à–∏—Ç—å —ç—Ç—É –∑–∞–¥–∞—á—É.

–í –∫–∞—á–µ—Å—Ç–≤–µ –ø—Ä–∏–º–∏—Ç–∏–≤–Ω–æ–≥–æ –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫–∞ –º–æ–∂–Ω–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω ¬´–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å¬ª.[^observer] –í –Ω—ë–º –º–æ–¥—É–ª–∏ –ø–æ–¥–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω—ã—Ö –≤–∏–¥–æ–≤ –∏ —Ä–µ–∞–≥–∏—Ä—É—é—Ç –Ω–∞ –Ω–∏—Ö, –∫–æ–≥–¥–∞ –æ–Ω–∏ –ø—Ä–∏—Ö–æ–¥—è—Ç:

```ts
// –ù–∞–±–ª—é–¥–∞—Ç–µ–ª—å ‚Äî —Ñ—É–Ω–∫—Ü–∏—è, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å
// –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è `Message`:

type Observer = (message: Message) => void;

// –ü–µ—Ä–µ–¥–∞—Ç—á–∏–∫ –¥–∞—ë—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ —Å–æ–±—ã—Ç–∏—è
// –∏ –º–æ–∂–µ—Ç —É–≤–µ–¥–æ–º–∏—Ç—å –≤—Å–µ—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –æ –Ω–æ–≤–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏:

type Observable = {
  subscribe: (listener: Observer) => void;
  notifyAll: (message: Message) => void;
};

// –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫–∞ –≤ –Ω–∞—à–µ–º —Å–ª—É—á–∞–µ ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç —Å –¥–≤—É–º—è –º–µ—Ç–æ–¥–∞–º–∏
// –∏ —Å–ø–∏—Å–æ–∫ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –≤ –≤–∏–¥–µ –º–∞—Å—Å–∏–≤–∞ `listeners`:

const listeners = [];
const bus: Observable = {
  subscribe: (listener) => listeners.push(listener),
  notifyAll: (message) => listener.forEach((listener) => listener(message)),
};

// –ü–æ–¥–ø–∏—Å—á–∏–∫ –±—É–¥–µ—Ç –∑–Ω–∞—Ç—å, —á—Ç–æ –µ–º—É –Ω–∞ –≤—Ö–æ–¥ –ø–µ—Ä–µ–¥–∞–¥—É—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ `Message` ‚Äî —ç—Ç–æ –∫–æ–Ω—Ç—Ä–∞–∫—Ç.
// –ü–æ —Ç–∏–ø—É —Å–æ–æ–±—â–µ–Ω–∏—è –æ–Ω —Å–º–æ–∂–µ—Ç –ø–æ–Ω—è—Ç—å, –Ω—É–∂–Ω–æ –ª–∏ –µ–º—É –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ:

const onUserUpdated = ({ type, payload }) => {
  if (type === "updateUser") {
    // –û—Ç—Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ,
    // –µ—Å–ª–∏ —Ç–∏–ø –ø–æ–¥—Ö–æ–¥–∏—Ç.

    const [firstName, lastName] = payload;
    // ...
  }
};

// –ü–æ–¥–ø–∏—Å–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `onUserUpdated` –Ω–∞ —Å–æ–æ–±—â–µ–Ω–∏—è
// –º–æ–∂–Ω–æ —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `subscribe`:

bus.subscribe(onUserUpdated);

// –ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—Ç—á–∏–∫ —É–≤–µ–¥–æ–º–∏—Ç –æ –Ω—ë–º
// –≤—Å–µ—Ö –ø–æ–¥–ø–∏—Å–∞–≤—à–∏—Ö—Å—è —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–æ–¥–∞ `notifyAll`:

bus.notifyAll({
  type: "updateUser",
  payload: ["Alex", "Bespoyasov"],
});
```

| –£—Ç–æ—á–Ω–µ–Ω–∏–µ üåä                                                                                                                                            |
| :------------------------------------------------------------------------------------------------------------------------------------------------------ |
| –í –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ –ø–∏—Å–∞—Ç—å —Å–≤–æ—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é ¬´–ù–∞–±–ª—é–¥–∞—Ç–µ–ª—è¬ª, –≤–µ—Ä–æ—è—Ç–Ω–æ, –Ω–µ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è. –î–ª—è —Ä–∞–±–æ—Ç—ã —Å —ç—Ç–∏–º –ø–∞—Ç—Ç–µ—Ä–Ω–æ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—Ç —Ä–µ—à–µ–Ω–∏—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, RxJS.[^rxjs] |

–ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞—Å—Ü–µ–ø–ª–µ–Ω–Ω–æ–µ –æ–±—â–µ–Ω–∏–µ –Ω—É–∂–Ω–æ –Ω–µ –≤—Å–µ–≥–¥–∞, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–Ω–æ, –∫–æ–≥–¥–∞ _–Ω–∞ –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã —Ä–µ–∞–≥–∏—Ä–æ–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —á–∞—Å—Ç–∏ —Å–∏—Å—Ç–µ–º—ã_, –Ω–æ –Ω–∞–º –Ω–µ —Ö–æ—á–µ—Ç—Å—è –ø–æ–≤—ã—à–∞—Ç—å –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ –º–µ–∂–¥—É –Ω–∏–º–∏.

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

–ì–æ–≤–æ—Ä—è –æ –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–∏ –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –º–æ–¥—É–ª–µ–π, —Å—Ç–æ–∏—Ç —É–ø–æ–º—è–Ω—É—Ç—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏. –ü–æ–¥ _–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏_ –¥–ª—è –ø—Ä–æ—Å—Ç–æ—Ç—ã –±—É–¥–µ–º –∏–º–µ—Ç—å –≤ –≤–∏–¥—É –ª—é–±–æ–π –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞—à–∏–º. –ù–∞–ø—Ä–∏–º–µ—Ä, –≤ —Ñ—É–Ω–∫—Ü–∏–∏ `randomInt` –∫—Ä–æ–º–µ –¥–≤—É—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–µ—Ç–æ–¥ `Math.random` ‚Äî —ç—Ç–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å:

```ts
function randomInt(min, max) {
  return Math.random() * (max - min) + min;
}
```

| –ö —Å–ª–æ–≤—É üëª                                                                                                                                                                                                                                                                                   |
| :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç `Math` –≤ –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ _–Ω–µ—è–≤–Ω–∞—è_, –ø–æ—Ç–æ–º—É —á—Ç–æ `Math` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞–ø—Ä—è–º—É—é –≤ —Ç–µ–ª–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –Ω–µ –æ–±–æ–∑–Ω–∞—á–µ–Ω, –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç. –¢–∞–∫–∏–µ –Ω–µ—è–≤–Ω—ã–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å–∏–ª–∏–≤–∞—é—Ç –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ. –ï—Å–ª–∏ –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `randomInt`, –Ω–∞–º –ø—Ä–∏–¥—ë—Ç—Å—è –¥–µ–ª–∞—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–æ–∫ –æ–±—ä–µ–∫—Ç–∞ `Math`. |

–£–ø—Ä–∞–≤–ª—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏ –º–æ–∂–Ω–æ –ø–æ-—Ä–∞–∑–Ω–æ–º—É, —ç—Ç–æ –∑–∞–≤–∏—Å–∏—Ç (no pun intended) –æ—Ç –ø–∞—Ä–∞–¥–∏–≥–º—ã –∏ —Å—Ç–∏–ª—è –∫–æ–¥–∞. –û–¥–Ω–∞–∫–æ –æ–±—ã—á–Ω–æ —É–¥–æ–±–Ω–æ –æ—Ç–¥–µ–ª—è—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏, –ø—Ä–æ–∏–∑–≤–æ–¥—è—â–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã, –æ—Ç –æ—Å—Ç–∞–ª—å–Ω—ã—Ö. –¢–∞–∫–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫–æ–¥ –∫ Impureim-—Å—Ç—Ä—É–∫—Ç—É—Ä–µ, –æ –ø–æ–ª—å–∑–µ –∫–æ—Ç–æ—Ä–æ–π –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏ –≤ –≥–ª–∞–≤–µ –æ —Å–∞–π–¥-—ç—Ñ—Ñ–µ–∫—Ç–∞—Ö. –î–∞–ª–µ–µ –º—ã –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø—Ä–∏–º–µ—Ä—ã —Ç–∞–∫–æ–≥–æ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–∞ –≤ –∫–æ–¥–µ, –Ω–∞–ø–∏—Å–∞–Ω–Ω–æ–º –≤ —Ä–∞–∑–Ω—ã—Ö –ø–∞—Ä–∞–¥–∏–≥–º–∞—Ö.

### –û–±—ä–µ–∫—Ç–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è

–í –æ–±—ä–µ–∫—Ç–Ω–æ-–æ—Ä–∏–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏ —é–Ω–∏—Ç –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç. –û–±—ä–µ–∫—Ç—ã –º–æ–≥—É—Ç —Å–º–µ—à–∏–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –¥–µ–π—Å—Ç–≤–∏—è (—Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –º–µ—Ç–æ–¥—ã), –∏ –ø–æ—ç—Ç–æ–º—É –∫–æ–º–ø–æ–Ω–æ–≤–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –æ–±—ã—á–Ω–æ —Ç—Ä—É–¥–Ω–µ–µ, —á–µ–º —Ñ—É–Ω–∫—Ü–∏–∏. –í —á–∞—Å—Ç–Ω–æ—Å—Ç–∏ –±–æ–ª—å—à–∞—è —á–∞—Å—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø—Ä–æ–µ–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ø—Ä–∏–Ω—Ü–∏–ø—ã SOLID —Ä–µ—à–∞—é—Ç –∏–º–µ–Ω–Ω–æ –ø—Ä–æ–±–ª–µ–º—ã –æ–±—ä–µ–∫—Ç–Ω–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏.[^solid]

| –ö —Å–ª–æ–≤—É üëÄ                                                                                                                                                                                                                                            |
| :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| –°—Ç–æ–∏—Ç –æ—Ç–º–µ—Ç–∏—Ç—å, —á—Ç–æ –æ–±—ä–µ–∫—Ç–Ω—ã–π –∫–æ–¥ _–º–æ–∂–Ω–æ_ –ø–∏—Å–∞—Ç—å –∏–∑–±–µ–≥–∞—è —ç—Ç–∏—Ö –ø—Ä–æ–±–ª–µ–º, –µ—Å–ª–∏ —Ä–∞–∑–¥–µ–ª—è—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –¥–µ–π—Å—Ç–≤–∏—è. –ü—Ä–æ—Å—Ç–æ –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫ —ç—Ç–æ–º—É –ø–æ–¥—Ç–∞–ª–∫–∏–≤–∞–µ—Ç —Å–∞–º–∞ –ø–∞—Ä–∞–¥–∏–≥–º–∞, –∞ –≤ –û–û–ü –ø—Ä–∏—Ö–æ–¥–∏—Ç—Å—è –ø—Ä–∏–∫–ª–∞–¥—ã–≤–∞—Ç—å —É—Å–∏–ª–∏—è, —á—Ç–æ–±—ã –æ–± —ç—Ç–æ–º –ø–æ–º–Ω–∏—Ç—å. |

–î–ª—è –ø—Ä–∏–º–µ—Ä–∞ –ø–æ—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–∞–º–∏:

```ts
class BudgetManager {
  constructor(private settings: BudgetSettings, private budget: Budget) {}

  // –ì–ª–∞–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –∫–æ–¥–∞ –≤ –Ω–∞—Ä—É—à–µ–Ω–∏–∏ CQS: –∑–¥–µ—Å—å —ç—Ñ—Ñ–µ–∫—Ç—ã —Å–º–µ—à–∞–Ω—ã —Å –ª–æ–≥–∏–∫–æ–π.
  // –≠—Ç–æ—Ç –∫–ª–∞—Å—Å –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –±—é–¥–∂–µ—Ç–∞...
  checkIncome(record: Record): MoneyAmount | boolean {
    if (record.createdAt > this.budget.endsAt) return false;

    const saving = record.amount * this.settings.piggyBankFraction;
    this.budget.topUp(record.amount - saving);

    return saving;
  }
}

// ...–ù–æ —ç—Ç–æ–≥–æ –Ω–µ –≤–∏–¥–Ω–æ –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏.
// –ú—ã –Ω–µ —Å–º–æ–∂–µ–º –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —á—Ç–æ –µ—Å—Ç—å –∫–∞–∫–æ–π-—Ç–æ —ç—Ñ—Ñ–µ–∫—Ç,
// –ø–æ–∫–∞ –Ω–µ –ø–æ—Å–º–æ—Ç—Ä–∏–º –≤–Ω—É—Ç—Ä—å –∫–æ–¥–∞ `BudgetManager`.
class AddIncomeCommandHandler {
  constructor(private manager: BudgetManager, private piggyBank: PiggyBank) {}

  execute({ record }: AddSpendingCommand) {
    const saving = this.manager.checkIncome(record);

    if (!saving) return false;
    this.piggyBank.add(saving);
  }
}
```

| –ö —Å–ª–æ–≤—É üíâ                                                                                                                                                                                                                                                             |
| :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| –í –ø—Ä–∏–º–µ—Ä–µ —è –ø–æ–¥—Ä–∞–∑—É–º–µ–≤–∞—é, —á—Ç–æ –º—ã –∏—Å–ø–æ–ª—å–∑—É–µ–º _–≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π (Dependency Injection, DI)_ —á–µ—Ä–µ–∑ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä—ã –∫–ª–∞—Å—Å–æ–≤.[^di] –Ø –Ω–µ –±—É–¥—É –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å—Å—è –Ω–∞ –Ω—ë–º –æ—Ç–¥–µ–ª—å–Ω–æ, –Ω–æ –æ—Å—Ç–∞–≤–ª—é –Ω–µ—Å–∫–æ–ª—å–∫–æ —Å—Å—ã–ª–æ–∫, –≥–¥–µ –æ–± —ç—Ç–æ–º –Ω–∞–ø–∏—Å–∞–Ω–æ –ø–æ–¥—Ä–æ–±–Ω–µ–µ.[^diindotnet][^ditsinpractice] |

–í –ø—Ä–∏–º–µ—Ä–µ –≤—ã—à–µ –∏–∑-–∑–∞ –Ω–∞—Ä—É—à–µ–Ω–∏—è CQS –Ω–∞–º –Ω–µ —è—Å–Ω–æ, _—Å–∫–æ–ª—å–∫–æ_ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –º–µ—Ç–æ–¥–∞ `execute`. –ú—ã —É–≤–∏–¥–µ–ª–∏ 2, –Ω–æ –Ω–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–π, —á—Ç–æ `this.budget.topUp` –Ω–µ –º–µ–Ω—è–µ—Ç —á—Ç–æ-–Ω–∏–±—É–¥—å –∫—Ä–æ–º–µ –æ–±—ä–µ–∫—Ç–∞ `budget`.

–ö–æ–º–ø–æ–Ω–æ–≤–∫–∞ —Å–∞–π–¥-—ç—Ñ—Ñ–µ–∫—Ç–æ–≤ —Å–≤–æ–¥–∏—Ç –Ω–∞ –Ω–µ—Ç —Å—É—Ç—å –∞–±—Å—Ç—Ä–∞–∫—Ü–∏–∏: —á–µ–º –±–æ–ª—å—à–µ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤, —Ç–µ–º –±–æ–ª—å—à–µ –æ–±—â–µ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∑–∞ –∫–æ—Ç–æ—Ä—ã–º –Ω–∞–¥–æ —Å–ª–µ–¥–∏—Ç—å –∏ –¥–µ—Ä–∂–∞—Ç—å –≤ –≥–æ–ª–æ–≤–µ ‚Äî —Å —ç—Ç–∏–º —Ç—Ä—É–¥–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å. –ï—Å–ª–∏ –∫–æ–º–ø–æ–Ω–æ–≤–∫–∏ —Å–∞–π–¥-—ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –º–æ–∂–Ω–æ –∏–∑–±–µ–∂–∞—Ç—å, —Ç–æ –ª—É—á—à–µ –µ—ë –∏–∑–±–µ–∂–∞—Ç—å.

–í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ –º–æ–∂–Ω–æ –≤—ã–¥–µ–ª–∏—Ç—å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –∞ —ç—Ñ—Ñ–µ–∫—Ç—ã –æ—Ç–æ–¥–≤–∏–Ω—É—Ç—å –∫ –∫—Ä–∞—è–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –¢–∞–∫ –ø–æ–ª—É—á–∏–ª–æ—Å—å –±—ã —Ä–∞–∑–¥–µ–ª–∏—Ç—å —ç—Ñ—Ñ–µ–∫—Ç—ã –∏ –ª–æ–≥–∏–∫—É:

```ts
// –í–∞–ª–∏–¥–∞—Ü–∏—é –≤—ã–Ω–µ—Å–µ–º –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é —Å—É—â–Ω–æ—Å—Ç—å.
// –≠—Ç–æ—Ç –∫–ª–∞—Å—Å –±—É–¥–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å—Å—è —Ç–æ–ª—å–∫–æ –≤–∞–ª–∏–¥–∞—Ü–∏–µ–π.
class AddIncomeValidator {
  constructor(private budget: Budget) {}

  // –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏, –º–µ—Ç–æ–¥ `canAddIncome` –º–æ–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å –ø–æ–ª–Ω–æ—Å—Ç—å—é —á–∏—Å—Ç—ã–º,
  // –µ—Å–ª–∏ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ `endsAt`, –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç.
  canAddIncome(record: Record) {
    return record.createdAt <= this.budget.endsAt;
  }
}

// –ù–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ —Ä–∞–∑–¥–µ–ª–∏–º –ª–æ–≥–∏–∫—É –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã.
// –ü–æ–ª—É—á–∏—Ç—Å—è Impureim-–±—É—Ç–µ—Ä–±—Ä–æ–¥, –æ –∫–æ—Ç–æ—Ä–æ–º –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏ —Ä–∞–Ω—å—à–µ:
// - –≠—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–±–æ—Ç–∞ —Å –ë–î –Ω–∞ –±–µ–∫–µ–Ω–¥–µ);
// - –õ–æ–≥–∏–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–¥–æ–º–µ–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏, —Å–æ–∑–¥–∞–Ω–∏–µ —Å—É—â–Ω–æ—Å—Ç–µ–π);
// - –≠—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö (–∏–ª–∏ –≤—ã–≤–æ–¥–∞ –Ω–∞ —ç–∫—Ä–∞–Ω).
class AddIncomeCommandHandler {
  constructor(
    // –≠—Ç–∞ –∂–µ —Ç–µ—Ö–Ω–∏–∫–∞ –ø–æ–∑–≤–æ–ª–∏—Ç ¬´–≤—ã—Ç–∞—â–∏—Ç—å¬ª –Ω–∞—Ä—É–∂—É –ø—Ä–æ–±–ª–µ–º—ã —Å –∑–∞—Ü–µ–ø–ª–µ–Ω–∏–µ–º.
    // –ï—Å–ª–∏ –≤ –∫–ª–∞—Å—Å–µ –Ω–∞–±–∏—Ä–∞–µ—Ç—Å—è —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π,
    // —Ç–æ, –≤–µ—Ä–æ—è—Ç–Ω–æ, —Å—Ç–æ–∏—Ç –ø–æ–¥—É–º–∞—Ç—å –æ–± —É–ª—É—á—à–µ–Ω–∏–∏ –µ–≥–æ –¥–∏–∑–∞–π–Ω–∞.
    private settings: BudgetSettings,
    private validator: AddIncomeValidator,
    private budget: Budget,
    private piggyBank: PiggyBank
  ) {}

  execute({ record }: AddSpendingCommand) {
    // –í–∞–ª–∏–¥–∞—Ü–∏—è:
    if (!this.validator.validate(record)) return false;

    // Pure(-ish because of injected settings) logic,
    // can be extracted into a separate module:

    // –ß–∏—Å—Ç–∞—è (–ø–æ—á—Ç–∏ ‚Äî –∏–∑-–∑–∞ –≤–Ω–µ–¥—Ä—ë–Ω–Ω—ã—Ö `this.settings`) –ª–æ–≥–∏–∫–∞.
    // –ï—ë –º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –∏–ª–∏ –º–æ–¥—É–ª—å,
    // —è —Ä–µ—à–∏–ª –æ—Å—Ç–∞–≤–∏—Ç—å –µ—ë –∑–¥–µ—Å—å –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏ ¬´—Å–ª–æ—ë–≤ –±—É—Ç–µ—Ä–±—Ä–æ–¥–∞¬ª:
    const saving = record.amount * this.settings.piggyBankFraction;
    const income = record.amount - saving;

    // –≠—Ñ—Ñ–µ–∫—Ç—ã –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:
    this.budget.topUp(income);
    this.piggyBank.add(saving);
  }
}
```

#### –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è

–°–ª–µ–¥—É—é—â–∏–º —à–∞–≥–æ–º –±—ã–ª–æ –±—ã —Ö–æ—Ä–æ—à–æ –æ—Ç–¥–µ–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –æ—Ç –ø–æ–≤–µ–¥–µ–Ω–∏—è. –û–±—ä–µ–∫—Ç—ã –±—é–¥–∂–µ—Ç–∞ –∏ –∫–æ–ø–∏–ª–∫–∏ —Ç–æ–≥–¥–∞ –ø—Ä–µ–≤—Ä–∞—Ç–∏–ª–∏—Å—å –±—ã –≤ ¬´–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö¬ª ‚Äî _—Å—É—â–Ω–æ—Å—Ç–∏ (entities –≤ —Ç–µ—Ä–º–∏–Ω–∞—Ö DDD)_,[^ddd][^dddclassification] –∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –¥–∞–Ω–Ω—ã—Ö –∑–∞–Ω–∏–º–∞–ª–∏—Å—å –±—ã ¬´—Å–µ—Ä–≤–∏—Å—ã¬ª:

```ts
class AddIncomeCommandHandler {
  constructor(
    private settings: BudgetSettings,
    private validator: AddIncomeValidator,
    private budgetRepository: BudgetUpdater,
    private piggyBankRepository: PiggyBankUpdater
  ) {}

  // –û–±—ä–µ–∫—Ç—ã –±—é–¥–∂–µ—Ç–∞ –∏ –∫–æ–ø–∏–ª–∫–∏ —Ç–µ–ø–µ—Ä—å –Ω–µ —Å–æ–¥–µ—Ä–∂–∞—Ç –ø–æ–≤–µ–¥–µ–Ω–∏—è, —Ç–æ–ª—å–∫–æ –¥–∞–Ω–Ω—ã–µ:
  execute({ record, budget, piggyBank }: AddSpendingCommand) {
    if (!this.validator.validate(record, budget)) return false;

    // –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö, –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∞:
    const saving = record.amount * this.settings.piggyBankFraction;
    const income = record.amount - saving;

    // –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏:
    const newBudget = new Budget({ ...budget, income });
    const newPiggyBank = new PiggyBank({ ...piggyBank, saving });

    // ¬´–°–µ—Ä–≤–∏—Å—ã¬ª —Å —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:
    this.budgetRepository.update(newBudget);
    this.piggyBankRepository.update(newPiggyBank);
  }
}
```

–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –ø–æ–º–æ–≥–∞–µ—Ç –æ—Ç–¥–µ–ª—è—Ç—å –∫–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –º–µ–Ω—è–µ—Ç—Å—è –±—ã—Å—Ç—Ä–æ (–ø–æ–≤–µ–¥–µ–Ω–∏–µ), –æ—Ç –∫–æ–¥–∞, –∫–æ—Ç–æ—Ä—ã–π –º–µ–Ω—è–µ—Ç—Å—è –º–µ–¥–ª–µ–Ω–Ω–æ (–¥–∞–Ω–Ω—ã–µ). –¢–∞–∫ –∏–∑–º–µ–Ω–µ–Ω–∏—è _–∑–∞—Ç—Ä–∞–≥–∏–≤–∞—é—Ç –º–µ–Ω—å—à–µ —Ñ–∞–π–ª–æ–≤_, –∏ —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –∏—Ö —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ –∫–æ–¥–æ–≤–æ–π –±–∞–∑–µ.[^pitsofsuccess]

#### –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

–ü—Ä–∏ –æ–ø–∏—Å–∞–Ω–∏–∏ –ø–æ–≤–µ–¥–µ–Ω–∏—è –º—ã –º–æ–∂–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CQS,[^cqs] –∫–∞–∫ ¬´–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ª–∏–Ω—Ç–µ—Ä¬ª. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –º—ã –æ–ø–∏—Å—ã–≤–∞–µ–º —Å–µ—Ä–≤–∏—Å —Å –Ω–∞–±–æ—Ä–æ–º –∫–æ–º–∞–Ω–¥, —Ä–∞–∑–Ω–∏—Ü–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä –º–æ–∂–µ—Ç —É–∫–∞–∑–∞—Ç—å –Ω–∞ –Ω–∞—Ä—É—à–µ–Ω–∏–µ CQS:

```ts
interface BudgetUpdater {
  updateBalance(balance: MoneyAmount): void;
  recalculateDuration(date: TimeStamp): void;

  // –£–ø—Å! –ú–µ—Ç–æ–¥ —á—Ç–æ-—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç,
  // –∑–Ω–∞—á–∏—Ç —ç—Ç–æ –∑–∞–ø—Ä–æ—Å, –∞ –Ω–µ –∫–æ–º–∞–Ω–¥–∞:
  currentBalance(): MoneyAmount;
}
```

–¢–æ–≥–¥–∞ –º—ã –º–æ–∂–µ–º –ø—Ä–∏–º–µ–Ω–∏—Ç—å _–ø—Ä–∏–Ω—Ü–∏–ø —Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ (Interface Segregation Principle, ISP)_[^solid] –∏ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–¥–∞—á—É:

```ts
interface BudgetSource {
  currentBalance(): MoneyAmount;
}

interface BudgetUpdater {
  updateBalance(balance: MoneyAmount): void;
  recalculateDuration(date: TimeStamp): void;
}
```

| –ö —Å–ª–æ–≤—É üëì                                                                                                                                                                                                                      |
| :------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| –û–¥–∏–Ω –∏–∑ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è ISP ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–∏—Å–æ–≤ —á—Ç–µ–Ω–∏—è –∏ –∑–∞–ø–∏—Å–∏ –¥–∞–Ω–Ω—ã—Ö. –†–∞–∑–¥–µ–ª—è—Ç—å –ª–∏ —Å–µ—Ä–≤–∏—Å—ã –Ω–∞ —É—Ä–æ–≤–Ω–µ –∫–ª–∞—Å—Å–æ–≤ ‚Äî –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∑–∞–¥–∞—á–∏, –Ω–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ —É—Ä–æ–≤–Ω–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–æ–≤ –ø–æ–º–æ–≥–∞–µ—Ç –∫–∞–∫ –º–∏–Ω–∏–º—É–º –≤—ã—Ä–∞–∑–∏—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –Ω–∞–º–µ—Ä–µ–Ω–∏–π. |

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è

–í –ø—Ä–æ–µ–∫—Ç–∞—Ö c ¬´–±–æ–ª–µ–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–º –∫–æ–¥–æ–º¬ª —Ç–æ–∂–µ –º–æ–∂–Ω–æ –≤—Å—Ç—Ä–µ—Ç–∏—Ç—å ¬´–≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π¬ª, —Å–¥–µ–ª–∞–Ω–Ω–æ–µ —Å –ø–æ–º–æ—â—å—é —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è —Ñ—É–Ω–∫—Ü–∏–π. –ü–æ–ª—å–∑–∞ —Ç–∞–∫–æ–≥–æ –≤–Ω–µ–¥—Ä–µ–Ω–∏—è –≤ —Ç–æ–º, —á—Ç–æ –æ–Ω–æ –¥–µ–ª–∞–µ—Ç _–Ω–µ—è–≤–Ω—ã–µ_ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ _—è–≤–Ω—ã–º–∏_.

–ù–∞–ø—Ä–∏–º–µ—Ä, —Ñ—É–Ω–∫—Ü–∏—è `listingQuery` –≤—ã–≤–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ md-—Ñ–∞–π–ª–æ–≤ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–π –ø–∞–ø–∫–∏:

```ts
const listingQuery = (query) => {
  return fs
    .readdirSync(query)
    .filter((fileName) => fileName.endsWith(".md"))
    .map((fileName) => fileName.replace(".md", ""));
};

const projectList = listingQuery("projects");
```

–û–Ω–∞ –Ω–µ—è–≤–Ω–æ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –º–æ–¥—É–ª—è `fs`, –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–µ. –í —Ü–µ–ª–æ–º, —ç—Ç–æ –Ω–µ —Å—Ç—Ä–∞—à–Ω–æ, –Ω–æ —Ç–∞–∫—É—é —Ñ—É–Ω–∫—Ü–∏—é –Ω–µ—É–¥–æ–±–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å ‚Äî –¥–ª—è –µ—ë —Ç–µ—Å—Ç–æ–≤ –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–π –º–æ–∫ –¥–ª—è `fs`.

–° —á–∞—Å—Ç–∏—á–Ω—ã–º –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ–º –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å ¬´—Ñ—É–Ω–∫—Ü–∏—é-—Ñ–∞–±—Ä–∏–∫—É¬ª. –û–Ω–∞ –±—É–¥–µ—Ç –ø—Ä–∏–Ω–∏–º–∞—Ç—å ¬´–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏¬ª, –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç, –∏ –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏—é `listingQuery`, –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```ts
/**
 * 1. –í–Ω–µ–¥—Ä–µ–Ω–∏–µ ¬´—Å–µ—Ä–≤–∏—Å–∞¬ª system;
 * 2. –ü–µ—Ä–µ–¥–∞—á–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–æ –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤;
 * 3. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ ¬´—Å–µ—Ä–≤–∏—Å–∞¬ª system
 *    –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω—É–∂–Ω—ã—Ö —ç—Ñ—Ñ–µ–∫—Ç–æ–≤.
 */
const createListingQuery =
  ({ system }) =>
  (query) =>
    system
      .readdirSync(query)
      .filter((fileName) => fileName.endsWith(".mdx"))
      .map((fileName) => fileName.replace(".mdx", ""));

// –¢–æ–≥–¥–∞ –ø—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –º—ã –±—ã —Å–ø–µ—Ä–≤–∞ ¬´–≤–Ω–µ–¥—Ä–∏–ª–∏¬ª system:
const listingQuery = createListingQuery({ system: fs });

// ...–ê –∑–∞—Ç–µ–º –±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ —Å–æ–∑–¥–∞–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é:
const projectList = listingQuery("projects");
```

–≠—Ç–æ—Ç –ø–æ–¥—Ö–æ–¥ ¬´–Ω–µ –æ—á–µ–Ω—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π¬ª, –Ω–æ —Å –Ω–∏–º –≤–ø–æ–ª–Ω–µ –º–æ–∂–Ω–æ —Ä–∞–±–æ—Ç–∞—Ç—å, –µ—Å–ª–∏ –Ω–∞–º –Ω–µ —Ç—Ä—É–¥–Ω–æ ¬´–≤–Ω–µ–¥—Ä—è—Ç—å¬ª –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –¥–ª—è –∫–∞–∂–¥–æ–π —Ç–∞–∫–æ–π —Ñ–∞–±—Ä–∏–∫–∏, –∞ –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–µ –¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å –æ–±—â–∏–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∏–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏.

#### –û—Ç–∫–∞–∑ –æ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

–í ¬´–±–æ–ª–µ–µ —Ö–∞—Ä–¥–∫–æ—Ä–Ω–æ–º¬ª –§–ü –º–µ–Ω—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å —Å–∞–π–¥-—ç—Ñ—Ñ–µ–∫—Ç—ã –Ω–µ –ø—Ä–∏–Ω—è—Ç–æ. –ü–æ–Ω—è—Ç–∏–µ ¬´–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π¬ª –≤ –ø—Ä–∏–≤—ã—á–Ω–æ–º –ø–æ–Ω–∏–º–∞–Ω–∏–∏ —Ç–∞–º –Ω–µ –æ—á–µ–Ω—å –ø–æ–¥—Ö–æ–¥–∏—Ç. –í–º–µ—Å—Ç–æ ¬´–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π¬ª, –∫–æ—Ç–æ—Ä—ã–µ ¬´–Ω–∞–¥–æ –¥—ë—Ä–≥–∞—Ç—å –∑–∞ –º–µ—Ç–æ–¥—ã¬ª, –∏ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –§–ü –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —è–¥—Ä–æ –≤ –∏–º–ø–µ—Ä–∞—Ç–∏–≤–Ω–æ–π –æ–±–æ–ª–æ—á–∫–µ.

| –ö —Å–ª–æ–≤—É üôÖ                                                                                                                                                                              |
| :-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| –ú–Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è, –∫–∞–∫ —ç—Ç—É –∫–æ–Ω—Ü–µ–ø—Ü–∏—é –ú–∞—Ä–∫ –°–∏–º–∞–Ω–Ω –Ω–∞–∑—ã–≤–∞–µ—Ç ‚Äî –æ—Ç–∫–∞–∑ –æ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.[^dependencyrejection] –ú—ã –∫–∞–∫ –±—ã –æ—Ç—Ö–æ–¥–∏–º –æ—Ç –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤–æ–æ–±—â–µ –∏ –ø—Ä–æ–±—É–µ–º —Ä–µ—à–∏—Ç—å –ø—Ä–æ–±–ª–µ–º—É –∏–Ω–∞—á–µ. |

–í —ç—Ç–æ–º –ø–æ–¥—Ö–æ–¥–µ _–≤—Å—è_ —Ä–∞–±–æ—Ç–∞ —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –æ—Ç–æ–¥–≤–∏–Ω—É—Ç–∞ –∫ –∫—Ä–∞—è–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —á–∏—Ç–∞—Ç—å –∏ –∑–∞–ø–∏—Å—ã–≤–∞—Ç—å (–∏–ª–∏ –≤—ã–≤–æ–¥–∏—Ç—å –Ω–∞ —ç–∫—Ä–∞–Ω) –¥–∞–Ω–Ω—ã–µ –º–æ–∂–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –Ω–∞—á–∞–ª–µ —Ä–∞–±–æ—Ç—ã –º–æ–¥—É–ª—è –∏ –≤ –∫–æ–Ω—Ü–µ. –í—Å—è —Ä–∞–±–æ—Ç–∞ –º–µ–∂–¥—É —ç—Ç–∏–º–∏ —Ç–æ—á–∫–∞–º–∏ —Å—Ç—Ä–æ–∏—Ç—Å—è –Ω–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è—Ö –¥–∞–Ω–Ω—ã—Ö.

–¢–æ –µ—Å—Ç—å –º—ã —Å–ø–µ—Ä–≤–∞ –ø–æ–ª—É—á–∞–µ–º –≤—Å–µ –Ω—É–∂–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ ¬´–≥—Ä—è–∑–Ω–æ–≥–æ¬ª –º–∏—Ä–∞, –ø–µ—Ä–µ–¥–∞—ë–º –∏—Ö –∫–∞–∫ –∞—Ä–≥—É–º–µ–Ω—Ç—ã –≤ —Ü–µ–ø–æ—á–∫—É –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π, –∞ –ø–æ—Ç–æ–º –∑–∞–ø–∏—Å—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç:

```ts
// –í—ã–Ω–æ—Å–∏–º —Ñ—É–Ω–∫—Ü–∏—é —Å –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º
// –Ω–∞–∑–≤–∞–Ω–∏–π —Ñ–∞–π–ª–æ–≤ –∫ –Ω–∞–∑–≤–∞–Ω–∏—è–º –ø–æ—Å—Ç–æ–≤,
// —Å–ø–∏—Å–æ–∫ –∫–æ—Ç–æ—Ä—ã—Ö –Ω–∞–¥–æ –≤–µ—Ä–Ω—É—Ç—å:
const listingQuery = (fileNames) =>
  // –ó–∞–º–µ—Ç—å—Ç–µ: –Ω–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç `fs`,
  // –º—ã —Ä–∞–±–æ—Ç–∞–µ–º —Ç–æ–ª—å–∫–æ —Å –¥–∞–Ω–Ω—ã–º–∏:
  fileNames
    .filter((fileName) => fileName.endsWith(".mdx"))
    .map((fileName) => fileName.replace(".mdx", ""));

// ¬´–ö–æ–º–ø–æ–∑–∏—Ü–∏—è¬ª —Ç–µ–ø–µ—Ä—å ‚Äî —ç—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è:
// - –æ–Ω–∞ —Å–ø–µ—Ä–≤–∞ –≤—ã–∑—ã–≤–∞–µ—Ç –Ω—É–∂–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã, —á—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –¥–∞–Ω–Ω—ã–µ,
// - –ø–æ—Ç–æ–º –ø—Ä–æ–≥–æ–Ω—è–µ—Ç –∏—Ö —á–µ—Ä–µ–∑ —Ü–µ–ø–æ—á–∫—É –≤—ã—á–∏—Å–ª–µ–Ω–∏–π,
// - –∞ –≤ –∫–æ–Ω—Ü–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–ª–∏ –≤—ã–∑—ã–≤–∞–µ—Ç —ç—Ñ—Ñ–µ–∫—Ç –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:
const listingQueryComposition = (query) => {
  // –í–Ω—É—Ç—Ä–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º Impureim-–±—É—Ç–µ—Ä–±—Ä–æ–¥.
  //
  // 1. –≠—Ñ—Ñ–µ–∫—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
  //    (–ò–º–µ–Ω–Ω–æ –∏–∑-–∑–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤–∏—è —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
  //     –∏ —Å–∞–º—É —Ñ—É–Ω–∫—Ü–∏—é –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ —Å—á–∏—Ç–∞—é—Ç ¬´–Ω–µ—á–∏—Å—Ç—ã–º–∏¬ª.)
  const files = fs.readdirSync(query);

  // 2. –õ–æ–≥–∏–∫–∞ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π –≤ –≤–∏–¥–µ —Ü–µ–ø–æ—á–∫–∏ —á–∏—Å—Ç—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π.
  return listingQuery(files);

  // 3. –≠—Ñ—Ñ–µ–∫—Ç –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.
  //    (–ï—Å–ª–∏ –º—ã –Ω–µ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏,
  //     –∞ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –µ–≥–æ, —Ç–æ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ü–µ–ø–æ—á–∫–∏ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–π
  //     –º—ã –±—ã –≤—ã–∑–≤–∞–ª–∏ —ç—Ñ—Ñ–µ–∫—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.)
};
```

–° –ø–µ—Ä–≤–æ–≥–æ –≤–∑–≥–ª—è–¥–∞ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ —Å—Ç–∞–ª–æ —Ö—É–∂–µ: –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –≥–ª–æ–±–∞–ª—å–Ω—ã–µ –º–æ–∫–∏, –∞ —Å ¬´–≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º¬ª –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–≥–ª—É—à–∫–∏ –Ω–∞ –º–µ—Å—Ç–æ —Å–µ—Ä–≤–∏—Å–æ–≤. –ù–æ –≤ —ç—Ç–æ–π –∫–æ–Ω—Ü–µ–ø—Ü–∏–∏ —é–Ω–∏—Ç-—Ç–µ—Å—Ç–∞–º–∏ –Ω–∞–¥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —è–¥—Ä–æ ‚Äî —Ñ—É–Ω–∫—Ü–∏—é `listingQuery`. –ö–æ–º–ø–æ–∑–∏—Ü–∏—é –≤ –ø—Ä–æ—Å—Ç—ã—Ö —Å–ª—É—á–∞—è—Ö –º–æ–∂–Ω–æ –≤–æ–æ–±—â–µ –Ω–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å, –∞ –≤ –±–æ–ª–µ–µ —Å–ª–æ–∂–Ω—ã—Ö ‚Äî –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ –∏–ª–∏ E2E-—Ç–µ—Å—Ç—ã.

–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –∂–µ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Ç–µ—Å—Ç–æ–≤ —Ç–∞–∫–∞—è –∫–æ–º–ø–æ–∑–∏—Ü–∏—è –ø–æ–¥—Ç–æ–ª–∫–Ω—ë—Ç –Ω–∞—Å –∫ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ ¬´–ü–æ—Ä—Ç—ã-–∞–¥–∞–ø—Ç–µ—Ä—ã¬ª, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–∂–µ—Ç —É–º–µ–Ω—å—à–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –º–æ–∫–æ–≤, —á—Ç–æ —Å–¥–µ–ª–∞–µ—Ç —Ç–µ—Å—Ç—ã –º–µ–Ω–µ–µ ¬´—Ö—Ä—É–ø–∫–∏–º–∏¬ª.[^testingprinciples]

| –ö —Å–ª–æ–≤—É üîå                                                          |
| :------------------------------------------------------------------ |
| –û–± –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ ¬´–ü–æ—Ä—Ç—ã-–∞–¥–∞–ø—Ç–µ—Ä—ã¬ª –º—ã –µ—â—ë –ø–æ–≥–æ–≤–æ—Ä–∏–º –≤ –æ—Ç–¥–µ–ª—å–Ω–æ–π –≥–ª–∞–≤–µ. |

–ú–æ–∫–∏ –Ω–∞–º –≤—Å—ë –µ—â—ë –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –¥–ª—è, –Ω–∞–ø—Ä–∏–º–µ—Ä, —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∞–¥–∞–ø—Ç–µ—Ä–æ–≤. –ù–æ –≤ —ç—Ç–æ–º —Å–ª—É—á–∞–µ –Ω–∞ –∫–∞–∂–¥—ã–π —Å–µ—Ä–≤–∏—Å –º—ã –Ω–∞–ø–∏—à–µ–º –ª–∏—à—å –æ–¥–∏–Ω –∞–¥–∞–ø—Ç–µ—Ä, –∞ –∑–Ω–∞—á–∏—Ç –∏ –º–æ–∫–∞—Ç—å —ç—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ª–∏—à—å –æ–¥–∏–Ω —Ä–∞–∑.

```ts
interface System {
  readDirectory(directory: DirectoryPath): List<FileName>;
}

const createAdapter = (service): System => ({
  readDirectory(directory) {
    /*...*/
  },
});

//  test.js

describe("when asked to read the given directory", () => {
  it("should trigger the `readdirSync` method on the service", () => {
    const mock = { readdirSync: jest.fn() };
    const adapter = createAdapter(mock);

    adapter.readDirectory("testdir");
    expect(mock.readdirSync).toHaveBeenCalledWith("testdir");
  });
});
```

–í —Å–ª—É—á–∞–µ —Å ¬´–≤–Ω–µ–¥—Ä–µ–Ω–∏–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π¬ª –º–æ–∫–∞—Ç—å —Å–µ—Ä–≤–∏—Å –ø—Ä–∏—Ö–æ–¥–∏–ª–æ—Å—å –±—ã _–¥–ª—è –∫–∞–∂–¥–æ–π —Ñ—É–Ω–∫—Ü–∏–∏_, –∫—É–¥–∞ —ç—Ç–æ—Ç —Å–µ—Ä–≤–∏—Å –≤–Ω–µ–¥—Ä—ë–Ω.

#### –î—Ä—É–≥–∏–µ —Å–ø–æ—Å–æ–±—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏

–ï—Å–ª–∏ –≤ –ø—Ä–æ–µ–∫—Ç–µ _–æ—á–µ–Ω—å –º–Ω–æ–≥–æ_ –æ–ø–µ—Ä–∞—Ü–∏–π –≤–≤–æ–¥–∞-–≤—ã–≤–æ–¥–∞, —Ç–æ —Ç–æ–≥–¥–∞ ¬´–≤–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π¬ª —á–µ—Ä–µ–∑ —á–∞—Å—Ç–∏—á–Ω–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø–æ–¥–æ–π–¥—ë—Ç, –≤–µ—Ä–æ—è—Ç–Ω–æ, –ª—É—á—à–µ.

–¢–µ–º –Ω–µ –º–µ–Ω–µ–µ, –¥–∞–∂–µ –µ—Å–ª–∏ –º—ã —Å–æ–±–∏—Ä–∞–µ–º—Å—è ¬´–≤–Ω–µ–¥—Ä—è—Ç—å¬ª —Å–µ—Ä–≤–∏—Å—ã, —ç—Ç–æ –±—É–¥–µ—Ç —Å–¥–µ–ª–∞—Ç—å –≥–æ—Ä–∞–∑–¥–æ –ø—Ä–æ—â–µ, –µ—Å–ª–∏ –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –º—ã —Ä–∞–∑–¥–µ–ª–∏–º –ª–æ–≥–∏–∫—É –∏ —ç—Ñ—Ñ–µ–∫—Ç—ã. –ü–æ—ç—Ç–æ–º—É –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º –∫–æ–¥–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–æ–≤ ‚Äî —ç—Ç–æ –ø–µ—Ä–≤—ã–π —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥, –∫–æ—Ç–æ—Ä—ã–π —Å—Ç–æ–∏—Ç —Å–¥–µ–ª–∞—Ç—å.

| –£—Ç–æ—á–Ω–µ–Ω–∏–µ ü¶Ñ                                                                                                                                                                                               |
| :--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| –í –§–ü –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∏ –¥—Ä—É–≥–∏–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏.[^readermonadfordi][^freemonadsfordi] –Ø –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω-–∫–æ–¥–µ –Ω–∞ JavaScript —Ç–∞–∫–æ–µ –≤–∏–¥–µ–ª —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, –ø–æ—ç—Ç–æ–º—É –Ω–µ –º–æ–≥—É —Å–∫–∞–∑–∞—Ç—å, –Ω–∞—Å–∫–æ–ª—å–∫–æ –æ–Ω–∏ —É–¥–æ–±–Ω—ã. |
| –•–æ—Ä–æ—à–∏–π –æ–±–∑–æ—Ä —Ç–µ—Ö–Ω–∏–∫ —Ä–∞–±–æ—Ç—ã —Å ¬´–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏¬ª –≤ –§–ü –æ–ø–∏—Å–∞–ª –°–∫–æ—Ç—Ç –í–ª–∞—à–∏–Ω –≤ —Å–≤–æ—ë–º —Ü–∏–∫–ª–µ —Å—Ç–∞—Ç–µ–π ‚ÄúSix approaches to dependency injection‚Äù.[^fpdependencies] –û—á–µ–Ω—å —Ä–µ–∫–æ–º–µ–Ω–¥—É—é –ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ –ø–µ—Ä–≤—ã–µ —Ç—Ä–∏ —Å—Ç–∞—Ç—å–∏. |

## –¶–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å

–í –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö —Å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –Ω–∞–º —Ç–∞–∫–∂–µ —Å—Ç–æ–∏—Ç —Å–ª–µ–¥–∏—Ç—å –∑–∞ _—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å—é –∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å—é_ –¥–∞–Ω–Ω—ã—Ö. –≠—Ç–æ —Å–≤–æ–π—Å—Ç–≤–∞, –∫–æ—Ç–æ—Ä—ã–µ –æ–±–µ—Å–ø–µ—á–∏–≤–∞—é—Ç –Ω–µ–ø—Ä–æ—Ç–∏–≤–æ—Ä–µ—á–∏–≤–æ—Å—Ç—å —Ç–æ–≥–æ, —á—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å.

| –ü–æ–¥—Ä–æ–±–Ω–µ–µ üìö                                                                                                                      |
| :-------------------------------------------------------------------------------------------------------------------------------- |
| –ü–æ–¥—Ä–æ–±–Ω–æ –æ–± —ç—Ç–æ–º –Ω–∞–ø–∏—Å–∞–ª –°–∫–æ—Ç—Ç –í–ª–∞—à–∏–Ω –≤ ‚ÄúDomain Modeling Made Functional‚Äù –≤ —Ä–∞–∑–¥–µ–ª–µ –æ–± –∞–≥—Ä–µ–≥–∞—Ç–∞—Ö –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö.[^dmmf] |

### –ê–≥—Ä–µ–≥–∞—Ç—ã

–°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å –æ–±–µ—Å–ø–µ—á–∏—Ç—å –ø—Ä–æ—â–µ –≤—Å–µ–≥–æ, –µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö –∏ —Å–ª–µ–¥–∏—Ç—å –∑–∞ –∏–Ω–∫–∞–ø—Å—É–ª—è—Ü–∏–µ–π.

–†–∞—Å—Å–º–æ—Ç—Ä–∏–º –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ. –ü—Ä–µ–¥—Å—Ç–∞–≤–∏–º, —á—Ç–æ –≤ –∫–æ–¥–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–∞ –∫–æ—Ä–∑–∏–Ω–∞ –¥–æ–ª–∂–Ω–∞ –≤—Å–µ–≥–¥–∞ –∏–º–µ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –∏—Ç–æ–≥–æ–≤—É—é —Å—É–º–º—É:

```ts
// cart.ts
type Cart = {
  items: ProductList;
  total: MoneyAmount;
};

function totalPrice(products: ProductList) {
  return products.reduce(
    (tally, { price, count }) => tally + price * amount,
    0
  );
}

function createCart(products: productList): Cart {
  return {
    items: products,
    total: totalPrice(products),
  };
}
```

–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏–∑–º–µ–Ω–∏–≤ –æ–±—ä–µ–∫—Ç –∫–æ—Ä–∑–∏–Ω—ã, –º—ã –º–æ–∂–µ–º —Ä–∞—Å—Å–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ. –î–æ–ø—É—Å—Ç–∏–º, –∫–∞–∫–æ–π-—Ç–æ –ø–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –∫–æ–¥ –¥–æ–±–∞–≤–∏–ª –Ω–æ–≤—ã–π –ø—Ä–æ–¥—É–∫—Ç –≤ —Å–ø–∏—Å–æ–∫:

```ts
// –ü–æ—Å—Ç–æ—Ä–æ–Ω–Ω–∏–π –∫–æ–¥ –Ω–µ –∑–Ω–∞–µ—Ç, —á—Ç–æ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞
// –Ω–∞–¥–æ –µ—â—ë –∏ –ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å –∏—Ç–æ–≥–æ–≤—É—é —Ü–µ–Ω—É:
userCart.products.push(appleJuice);

// –¢–µ–ø–µ—Ä—å –ø–æ–ª–µ `cart.total` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ,
// –ø–æ—Ç–æ–º—É —á—Ç–æ –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–¥—É–∫—Ç–∞ –æ–Ω–æ –Ω–µ –±—ã–ª–æ –ø–µ—Ä–µ—Å—á–∏—Ç–∞–Ω–æ.
```

–ö—É—Å–æ–∫ –¥–∞–Ω–Ω—ã—Ö, –∫–æ—Ç–æ—Ä—ã–µ –¥–æ–ª–∂–Ω—ã –æ–±–Ω–æ–≤–ª—è—Ç—å—Å—è ¬´–∫–∞–∫ –µ–¥–∏–Ω–æ–µ —Ü–µ–ª–æ–µ¬ª ‚Äî —ç—Ç–æ _–∞–≥—Ä–µ–≥–∞—Ç_. –ù–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –º–æ–∂–µ—Ç –ø–æ–º–æ—á—å –¥–µ—Ä–∂–∞—Ç—å –∞–≥—Ä–µ–≥–∞—Ç—ã —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–º–∏. –û–Ω–∞ –ø—Ä–∏–Ω—É–∂–¥–∞–µ—Ç –∫ —Ç–æ–º—É, —á—Ç–æ–±—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞–≥—Ä–µ–≥–∞—Ç–∞ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ, _–Ω–∞—á–∏–Ω–∞—è —Å –µ–≥–æ –∫–æ—Ä–Ω–µ–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è_:

```ts
// cart.ts
// ...

function addProduct(cart: Cart, product: Product): Cart {
  const products = [...cart.products, product];
  const total = totalPrice(updatedProducts);
  return { products, total };
}

// ...

addProduct(userCart, appleJuice);
```

–§—É–Ω–∫—Ü–∏—è `addProduct` –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–Ω–∞ –∑–Ω–∞–µ—Ç, –∫–∞–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –∏ –æ—Ç–∫—É–¥–∞ –æ–±–Ω–æ–≤–ª—è—Ç—å, —á—Ç–æ–±—ã –æ–Ω–∏ –±—ã–ª–∏ –≤–∞–ª–∏–¥–Ω—ã–º–∏. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ ‚Äî –µ—ë –∑–æ–Ω–∞ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏, –∞–≥—Ä–µ–≥–∞—Ç ‚Äî –æ–±–ª–∞—Å—Ç—å –≤–ª–∏—è–Ω–∏—è.

### –ü—Ä–µ–¥–≤–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞ –≤—Ö–æ–¥–µ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç

–ê–≥—Ä–µ–≥–∞—Ç—ã –∏ –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ—Å—Ç—å –ø–æ–º–æ–≥–∞—é—Ç –¥–µ—Ä–∂–∞—Ç—å –¥–∞–Ω–Ω—ã–µ _–≤–Ω—É—Ç—Ä–∏_ —á–∞—Å—Ç–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–∞–ª–∏–¥–Ω—ã–º–∏ –∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–º–∏. –ê —á—Ç–æ–±—ã –Ω–µ–≤–∞–ª–∏–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –≤ –Ω–µ–≥–æ _–Ω–µ –ø–æ–ø–∞–ª–∏_, –Ω—É–∂–Ω–∞ –ø—Ä–µ–¥–≤–∞–ª–∏–¥–∞—Ü–∏—è.

| –ü–æ–¥—Ä–æ–±–Ω–µ–µ üëÄ                                                                                                                                                     |
| :--------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| –í —Ç–µ—Ä–º–∏–Ω–∞—Ö DDD –æ–±–æ—Å–æ–±–ª–µ–Ω–Ω–∞—è —á–∞—Å—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞–∑—ã–≤–∞–µ—Ç—Å—è –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–º. –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± —ç—Ç–æ–º –ø–æ–Ω—è—Ç–∏–∏ –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏ —Ä–∞–Ω–µ–µ –≤ –≥–ª–∞–≤–µ –æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–º –ø–∞–π–ø–ª–∞–π–Ω–µ. |

–¢–æ –µ—Å—Ç—å –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ `Cart` –≤–º–µ—Å—Ç–æ –∞–¥-—Ö–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ –Ω–∞ –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è:

```js
function Cart({ items }) {
  return (
    !!items && (
      <ul>
        {items.map((item) =>
          item && item.product ? (
            <li key={item.id}>
              {item.product?.name ?? "‚Äî"}: {item.product?.price} √ó{" "}
              {item.product?.count ?? 0}
            </li>
          ) : null
        )}
      </ul>
    )
  );
}
```

...–ú–æ–∂–Ω–æ —Å–ø–µ—Ä–≤–∞ –ø—Ä–æ–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ, –æ–±—Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –æ—à–∏–±–∫–∏:

```js
function hasCorruptedItem(item) {
  return !item || !item.product;
}

function validateCart(cart) {
  if (!cart || !cart.items) return Result.failure("EMPTY_CART");
  if (cart.items.some(hasCorruptedItem))
    return Result.failure("CORRUPTED_ITEM");

  // –í–º–µ—Å—Ç–æ Result –≤–∞—à –ø—Ä–æ–µ–∫—Ç –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Å–∫–ª—é—á–µ–Ω–∏—è.
  // –ü–æ–¥—Ä–æ–±–Ω–µ–µ –æ–± –æ–±—Ä–∞–±–æ—Ç–∫–µ –æ—à–∏–±–æ–∫ –º—ã –≥–æ–≤–æ—Ä–∏–ª–∏ –≤ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≥–ª–∞–≤–µ.

  // –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–æ–π –æ—à–∏–±–∫–∞–º –º–æ–∂–µ—Ç –±—ã—Ç—å ¬´–¥–µ—Ñ–æ–ª—Ç–Ω–∞—è¬ª –∫–æ—Ä–∑–∏–Ω–∞ –∫–∞–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤–∞–ª–∏–¥–∞—Ü–∏–∏,
  // –Ω–æ –º–Ω–µ –≤—Å—ë –∂–µ –∫–∞–∂–µ—Ç—Å—è, —á—Ç–æ –Ω–∞—Ä—É—à–µ–Ω–∏–µ –∫–æ–Ω—Ç—Ä–∞–∫—Ç–∞ API ‚Äî –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –¥–ª—è –æ—à–∏–±–∫–∏.

  return cart;
}
```

...–ê –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å _—É–∂–µ –≤–∞–ª–∏–¥–Ω—ã–µ –∏ –ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã–µ_ –¥–∞–Ω–Ω—ã–µ:

```js
// ...

function Cart({ items }) {
  return (
    <ul>
      {items.map(({ id, product }) => (
        <li key={id}>
          {product.name}: {product.price} √ó {product.count}
        </li>
      ))}
    </ul>
  );
}
```

[^pitsofsuccess]: ‚ÄúFunctional architecture: The pits of success‚Äù by Mark Seemann, https://youtu.be/US8QG9I1XW0
[^cqs]: ‚ÄúCommand-Query Separation‚Äù by Martin Fowler, https://martinfowler.com/bliki/CommandQuerySeparation.html
[^coupling]: –ó–∞—Ü–µ–ø–ª–µ–Ω–∏–µ –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏, –í–∏–∫–∏–ø–µ–¥–∏—è, https://ru.wikipedia.org/wiki/–ó–∞—Ü–µ–ø–ª–µ–Ω–∏–µ_(–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ)
[^soc]: –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏, –í–∏–∫–∏–ø–µ–¥–∏—è, https://ru.wikipedia.org/wiki/–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ_–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
[^cohesion]: –°–≤—è–∑–Ω–æ—Å—Ç—å –≤ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–∏, –í–∏–∫–∏–ø–µ–¥–∏—è, https://ru.wikipedia.org/wiki/–°–≤—è–∑–Ω–æ—Å—Ç—å_(–ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ)
[^faetureenvy]: Feature Envy, Refactoring Guru, https://refactoring.guru/smells/feature-envy
[^designbycontract]: ‚ÄúDesign By Contract‚Äù, c2.com, https://wiki.c2.com/?DesignByContract
[^contractprogramming]: ¬´–ö–æ–Ω—Ç—Ä–∞–∫—Ç–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ¬ª –¢–∏–º—É—Ä –®–µ–º—Å–µ–¥–∏–Ω–æ–≤, https://youtu.be/K5_kSUvbGEQ
[^strategy]: Strategy Pattern, Refactoring Guru, https://refactoring.guru/design-patterns/strategy
[^rest]: REpresentational State Transfer, REST, https://restfulapi.net
[^messagebroker]: Message Broker, Microsoft Docs, https://docs.microsoft.com/en-us/previous-versions/msp-n-p/ff648849(v=pandp.10)
[^messagebus]: Message Bus, Microsoft Docs, https://docs.microsoft.com/en-us/previous-versions/msp-n-p/ff647328(v=pandp.10)
[^messagequeue]: Message Queue, Wikipedia, https://en.wikipedia.org/wiki/Message_queue
[^observer]: Observer Pattern, Refactoring Guru, https://refactoring.guru/design-patterns/observer
[^rxjs]: RxJS, Reactive Extensions Library for JavaScript, https://rxjs.dev
[^solid]: The Principles of OOD, Robert C. Martin, http://www.butunclebob.com/ArticleS.UncleBob.PrinciplesOfOod
[^di]: ‚ÄúInversion of Control Containers and the Dependency Injection pattern‚Äù by Martin Fowler, https://martinfowler.com/articles/injection.html
[^diindotnet]: ‚ÄúDependency Injection in .NET‚Äù by Mark Seemann, https://www.goodreads.com/book/show/9407722-dependency-injection-in-net
[^ditsinpractice]: –í–Ω–µ–¥—Ä–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π —Å TypeScript –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ, https://bespoyasov.ru/blog/di-ts-in-practice/
[^ddd]: ‚ÄúDomain-Driven Design‚Äù by Eric Evans, https://www.goodreads.com/book/show/179133.Domain_Driven_Design
[^dddclassification]: ‚ÄúEvans Classification‚Äù by Martin Fowler, https://martinfowler.com/bliki/EvansClassification.html
[^dependencyrejection]: ‚ÄúDependency Rejection‚Äù by Mark Seemann, https://blog.ploeh.dk/2017/02/02/dependency-rejection/
[^readermonadfordi]: ‚ÄúDependency Injection Using the Reader Monad‚Äù by Scott Wlaschin, https://fsharpforfunandprofit.com/posts/dependencies-3/
[^freemonadsfordi]: ‚ÄúDependency Interpretation‚Äù by Scott Wlaschin, https://fsharpforfunandprofit.com/posts/dependencies-4/
[^fpdependencies]: ‚ÄúSix approaches to dependency injection‚Äù by Scott Wlaschin, https://fsharpforfunandprofit.com/posts/dependencies/
[^dmmf]: ‚ÄúDomain Modeling Made Functional‚Äù by Scott Wlaschin, https://www.goodreads.com/book/show/34921689-domain-modeling-made-functional
[^testingprinciples]: ‚ÄúUnit Testing: Principles, Practices, and Patterns‚Äù by Vladimir Khorikov, https://www.goodreads.com/book/show/48927138-unit-testing
